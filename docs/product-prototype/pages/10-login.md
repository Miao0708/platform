# ç™»å½•é¡µé¢åŸå‹

## é¡µé¢æ¦‚è¿°
ç™»å½•é¡µé¢æä¾›ç”¨æˆ·èº«ä»½è®¤è¯åŠŸèƒ½ï¼Œæ”¯æŒå¤šç§ç™»å½•æ–¹å¼ã€å®‰å…¨éªŒè¯ã€è®°ä½ç™»å½•çŠ¶æ€ç­‰åŠŸèƒ½ï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„UIè®¾è®¡å’Œå®Œå–„çš„å®‰å…¨æœºåˆ¶ã€‚

## é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           å·¦ä¾§èƒŒæ™¯åŒºåŸŸ           â”‚  â”‚          å³ä¾§ç™»å½•åŒºåŸŸ              â”‚ â”‚
â”‚  â”‚                                 â”‚  â”‚                                   â”‚ â”‚
â”‚  â”‚  ğŸ¨ åŠ¨æ€æ¸å˜èƒŒæ™¯                â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚      AIç ”å‘è¾…åŠ©å¹³å°          â”‚  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   ğŸš€ å¹³å°ç‰¹æ€§å±•ç¤º        â”‚    â”‚  â”‚  â”‚  ğŸ‘‹ æ¬¢è¿å›æ¥                â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚  â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  âœ¨ æ™ºèƒ½ä»£ç åˆ†æ         â”‚    â”‚  â”‚  â”‚  ğŸ” ç™»å½•æ–¹å¼é€‰æ‹©ï¼š           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ¤– AIè¾…åŠ©å¼€å‘          â”‚    â”‚  â”‚  â”‚  â—‹ ç”¨æˆ·åå¯†ç                â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ“Š å¯è§†åŒ–æŠ¥å‘Š          â”‚    â”‚  â”‚  â”‚  â—‹ ä¼ä¸šSSO                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ”„ è‡ªåŠ¨åŒ–æµæ°´çº¿        â”‚    â”‚  â”‚  â”‚  â—‹ ç¬¬ä¸‰æ–¹ç™»å½•               â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ›¡ï¸ å®‰å…¨å®¡è®¡           â”‚    â”‚  â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  [äº†è§£æ›´å¤š â†’]           â”‚    â”‚  â”‚  â”‚  â”‚ğŸ“§ ç”¨æˆ·å/é‚®ç®±            â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚  â”‚  â”‚ user@example.com        â”‚  â”‚  â”‚ â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    ğŸ’¡ ä»Šæ—¥æç¤º           â”‚    â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚  â”‚  â”‚  â”‚ğŸ”’ å¯†ç                   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  ä½¿ç”¨AIåŠ©æ‰‹æå‡ä»£ç è´¨é‡ï¼Œ â”‚    â”‚  â”‚  â”‚  â”‚ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢        â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  è®©å¼€å‘æ•ˆç‡ç¿»å€ï¼        â”‚    â”‚  â”‚  â”‚  â”‚               [ğŸ‘]      â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  "ä»Šå¤©å·²æœ‰128ä½å¼€å‘è€…     â”‚    â”‚  â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   ä½¿ç”¨å¹³å°å®Œæˆä»£ç å®¡æŸ¥"   â”‚    â”‚  â”‚  â”‚  â˜ è®°ä½ç™»å½•çŠ¶æ€              â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  ç‰ˆæœ¬: v2.1.0                   â”‚  â”‚  â”‚  â”‚   ğŸ”‘ ç™»å½•              â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  æœ€åæ›´æ–°: 2024-01-15           â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚                                 â”‚  â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  æˆ–è€…ä½¿ç”¨ï¼š                  â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  [GitHub] [Google] [å¾®ä¿¡]    â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  ğŸ”— å¿˜è®°å¯†ç ï¼Ÿ               â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  ğŸ†• è¿˜æ²¡æœ‰è´¦å·ï¼Ÿç«‹å³æ³¨å†Œ      â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  ğŸŒ è¯­è¨€: ä¸­æ–‡ â–¼             â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  ğŸŒ™ ä¸»é¢˜: è‡ªåŠ¨ â–¼             â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚                             â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚                                       â”‚  â”‚  â”‚    ğŸ” éªŒè¯ç éªŒè¯         â”‚  â”‚ â”‚ â”‚
â”‚                                       â”‚  â”‚  â”‚                         â”‚  â”‚ â”‚ â”‚
â”‚                                       â”‚  â”‚  â”‚  è¯·è¾“å…¥éªŒè¯ç ï¼š           â”‚  â”‚ â”‚ â”‚
â”‚                                       â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚ â”‚
â”‚                                       â”‚  â”‚  â”‚  â”‚KXPQ â”‚ â”‚ [è¾“å…¥éªŒè¯ç ] â”‚ â”‚  â”‚ â”‚ â”‚
â”‚                                       â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚ â”‚
â”‚                                       â”‚  â”‚  â”‚           [åˆ·æ–°éªŒè¯ç ]   â”‚  â”‚ â”‚ â”‚
â”‚                                       â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚                                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”‚  é¡µè„š: Â© 2024 AIç ”å‘è¾…åŠ©å¹³å°. ä¿ç•™æ‰€æœ‰æƒåˆ©. | éšç§æ”¿ç­– | æœåŠ¡æ¡æ¬¾ | å¸®åŠ©ä¸­å¿ƒ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ•°æ®æ¨¡å‹

### ç”¨æˆ·è®¤è¯æ¥å£
```typescript
interface LoginRequest {
  // åŸºç¡€ç™»å½•
  username?: string
  email?: string
  password?: string
  
  // éªŒè¯ç 
  captcha?: string
  captchaId?: string
  
  // äºŒæ¬¡éªŒè¯
  mfaCode?: string
  mfaMethod?: 'totp' | 'sms' | 'email'
  
  // ç™»å½•é€‰é¡¹
  rememberMe: boolean
  loginType: LoginType
  
  // è®¾å¤‡ä¿¡æ¯
  deviceInfo: DeviceInfo
  
  // SSOç™»å½•
  ssoProvider?: SSOProvider
  ssoToken?: string
  
  // ç¬¬ä¸‰æ–¹ç™»å½•
  oauthProvider?: OAuthProvider
  oauthCode?: string
  oauthState?: string
}

interface LoginResponse {
  success: boolean
  token?: string
  refreshToken?: string
  user?: UserProfile
  sessionId?: string
  expiresAt?: string
  
  // å®‰å…¨æ£€æŸ¥ç»“æœ
  securityCheck: SecurityCheckResult
  
  // éœ€è¦é¢å¤–éªŒè¯
  requiresMFA?: boolean
  mfaMethods?: MFAMethod[]
  
  // ç™»å½•å¤±è´¥ä¿¡æ¯
  error?: string
  errorCode?: string
  remainingAttempts?: number
  lockoutTime?: string
  
  // é¦–æ¬¡ç™»å½•
  isFirstLogin?: boolean
  mustChangePassword?: boolean
  
  // è®¾å¤‡éªŒè¯
  requiresDeviceVerification?: boolean
  verificationMethods?: VerificationMethod[]
}

interface UserProfile {
  id: string
  username: string
  email: string
  displayName: string
  avatar?: string
  roles: Role[]
  permissions: Permission[]
  preferences: UserPreferences
  lastLoginAt?: string
  loginCount: number
  accountStatus: AccountStatus
}

interface DeviceInfo {
  userAgent: string
  platform: string
  browser: string
  browserVersion: string
  os: string
  osVersion: string
  screen: ScreenInfo
  timezone: string
  language: string
  fingerprint: string
}

interface SecurityCheckResult {
  deviceTrusted: boolean
  locationSuspicious: boolean
  timePatternNormal: boolean
  riskScore: number
  riskLevel: 'low' | 'medium' | 'high'
  recommendations: string[]
}

interface MFAMethod {
  type: 'totp' | 'sms' | 'email' | 'hardware_key'
  enabled: boolean
  verified: boolean
  setupRequired?: boolean
  phoneNumber?: string
  email?: string
}

type LoginType = 'username' | 'email' | 'sso' | 'oauth'
type SSOProvider = 'azure_ad' | 'okta' | 'auth0' | 'ldap'
type OAuthProvider = 'github' | 'google' | 'wechat' | 'dingtalk'
type AccountStatus = 'active' | 'inactive' | 'locked' | 'suspended' | 'pending_verification'
```

### çŠ¶æ€ç®¡ç†
```typescript
interface AuthState {
  // ç”¨æˆ·çŠ¶æ€
  isAuthenticated: boolean
  user: UserProfile | null
  token: string | null
  refreshToken: string | null
  sessionId: string | null
  
  // ç™»å½•çŠ¶æ€
  isLogging: boolean
  loginAttempts: number
  lastLoginAttempt: string | null
  isLocked: boolean
  lockoutTime: string | null
  
  // éªŒè¯çŠ¶æ€
  requiresCaptcha: boolean
  captchaId: string | null
  requiresMFA: boolean
  mfaMethods: MFAMethod[]
  currentMFAStep: string | null
  
  // å®‰å…¨çŠ¶æ€
  deviceTrusted: boolean
  securityAlerts: SecurityAlert[]
  riskLevel: 'low' | 'medium' | 'high'
  
  // UIçŠ¶æ€
  loginType: LoginType
  showPassword: boolean
  rememberMe: boolean
  
  // ç¬¬ä¸‰æ–¹ç™»å½•
  oauthProviders: OAuthProvider[]
  oauthLoading: Record<OAuthProvider, boolean>
  
  // SSOé…ç½®
  ssoProviders: SSOConfig[]
  ssoEnabled: boolean
  
  // é”™è¯¯çŠ¶æ€
  error: string | null
  fieldErrors: Record<string, string>
  
  // è®¾å¤‡å’Œç¯å¢ƒ
  deviceInfo: DeviceInfo | null
  clientConfig: ClientConfig
  
  // é¦–æ¬¡ç™»å½•æµç¨‹
  isFirstLogin: boolean
  mustChangePassword: boolean
  passwordChangeRequired: boolean
}

interface AuthActions {
  // åŸºç¡€ç™»å½•
  login(credentials: LoginRequest): Promise<LoginResponse>
  logout(): Promise<void>
  refreshAccessToken(): Promise<void>
  
  // å¯†ç ç®¡ç†
  changePassword(oldPassword: string, newPassword: string): Promise<void>
  resetPassword(email: string): Promise<void>
  confirmPasswordReset(token: string, newPassword: string): Promise<void>
  
  // å¤šå› å­è®¤è¯
  setupMFA(method: MFAMethod): Promise<void>
  verifyMFA(code: string, method: string): Promise<void>
  disableMFA(method: string): Promise<void>
  
  // éªŒè¯ç 
  getCaptcha(): Promise<{ id: string, image: string }>
  refreshCaptcha(): Promise<void>
  
  // ç¬¬ä¸‰æ–¹ç™»å½•
  loginWithOAuth(provider: OAuthProvider): Promise<void>
  handleOAuthCallback(code: string, state: string): Promise<void>
  
  // SSOç™»å½•
  loginWithSSO(provider: SSOProvider): Promise<void>
  handleSSOCallback(token: string): Promise<void>
  
  // è®¾å¤‡ç®¡ç†
  trustDevice(): Promise<void>
  revokeDeviceTrust(deviceId: string): Promise<void>
  getDeviceList(): Promise<Device[]>
  
  // ä¼šè¯ç®¡ç†
  getCurrentSession(): Promise<Session>
  getActiveSessions(): Promise<Session[]>
  revokeSession(sessionId: string): Promise<void>
  revokeAllSessions(): Promise<void>
  
  // å®‰å…¨æ£€æŸ¥
  checkSecurityStatus(): Promise<SecurityStatus>
  reportSuspiciousActivity(details: string): Promise<void>
  
  // UIæ“ä½œ
  setLoginType(type: LoginType): void
  togglePasswordVisibility(): void
  setRememberMe(remember: boolean): void
  clearErrors(): void
  
  // ç”¨æˆ·åå¥½
  updatePreferences(preferences: Partial<UserPreferences>): Promise<void>
  
  // è´¦æˆ·éªŒè¯
  sendEmailVerification(): Promise<void>
  verifyEmail(token: string): Promise<void>
  sendPhoneVerification(): Promise<void>
  verifyPhone(code: string): Promise<void>
}
```

## é¡µé¢äº¤äº’é€»è¾‘

### åŸºç¡€ç™»å½•æµç¨‹
```typescript
// æ‰§è¡Œç™»å½•
async function handleLogin() {
  clearErrors()
  
  // éªŒè¯è¡¨å•
  const validation = validateLoginForm()
  if (!validation.valid) {
    setFieldErrors(validation.errors)
    return
  }
  
  isLogging.value = true
  
  try {
    const loginData: LoginRequest = {
      [loginType.value === 'email' ? 'email' : 'username']: credentials.username,
      password: credentials.password,
      captcha: captchaCode.value,
      captchaId: captchaId.value,
      rememberMe: rememberMe.value,
      loginType: loginType.value,
      deviceInfo: await getDeviceInfo()
    }
    
    const response = await authStore.login(loginData)
    
    if (response.success) {
      if (response.requiresMFA) {
        // éœ€è¦å¤šå› å­è®¤è¯
        setupMFAVerification(response.mfaMethods)
      } else if (response.requiresDeviceVerification) {
        // éœ€è¦è®¾å¤‡éªŒè¯
        setupDeviceVerification(response.verificationMethods)
      } else {
        // ç™»å½•æˆåŠŸ
        handleLoginSuccess(response)
      }
    } else {
      handleLoginError(response)
    }
    
  } catch (error) {
    handleLoginException(error)
  } finally {
    isLogging.value = false
  }
}

// å¤„ç†ç™»å½•æˆåŠŸ
function handleLoginSuccess(response: LoginResponse) {
  showSuccessMessage('ç™»å½•æˆåŠŸï¼Œæ¬¢è¿å›æ¥ï¼')
  
  // æ£€æŸ¥é¦–æ¬¡ç™»å½•
  if (response.isFirstLogin) {
    showWelcomeModal()
  }
  
  // æ£€æŸ¥å¯†ç è¿‡æœŸ
  if (response.mustChangePassword) {
    navigateToPasswordChange()
    return
  }
  
  // ä¿å­˜ç™»å½•çŠ¶æ€
  if (rememberMe.value) {
    localStorage.setItem('rememberMe', 'true')
    localStorage.setItem('lastUsername', credentials.username)
  }
  
  // è·³è½¬åˆ°ç›®æ ‡é¡µé¢
  const redirectUrl = route.query.redirect as string || '/dashboard'
  router.push(redirectUrl)
}

// å¤„ç†ç™»å½•å¤±è´¥
function handleLoginError(response: LoginResponse) {
  loginAttempts.value++
  lastLoginAttempt.value = new Date().toISOString()
  
  if (response.errorCode === 'INVALID_CREDENTIALS') {
    setError('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯')
    
    if (response.remainingAttempts <= 3) {
      showWarningMessage(`å‰©ä½™å°è¯•æ¬¡æ•°: ${response.remainingAttempts}`)
    }
  } else if (response.errorCode === 'ACCOUNT_LOCKED') {
    setError('è´¦æˆ·å·²è¢«é”å®šï¼Œè¯·ç¨åå†è¯•')
    showAccountLockedModal(response.lockoutTime)
  } else if (response.errorCode === 'CAPTCHA_REQUIRED') {
    requiresCaptcha.value = true
    await refreshCaptcha()
  } else {
    setError(response.error || 'ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•')
  }
  
  // å®‰å…¨æ£€æŸ¥å»ºè®®
  if (response.securityCheck?.riskLevel === 'high') {
    showSecurityWarning(response.securityCheck.recommendations)
  }
}

// è¡¨å•éªŒè¯
function validateLoginForm(): ValidationResult {
  const errors: Record<string, string> = {}
  
  // ç”¨æˆ·å/é‚®ç®±éªŒè¯
  if (!credentials.username) {
    errors.username = 'è¯·è¾“å…¥ç”¨æˆ·åæˆ–é‚®ç®±'
  } else if (loginType.value === 'email' && !isValidEmail(credentials.username)) {
    errors.username = 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'
  }
  
  // å¯†ç éªŒè¯
  if (!credentials.password) {
    errors.password = 'è¯·è¾“å…¥å¯†ç '
  } else if (credentials.password.length < 6) {
    errors.password = 'å¯†ç é•¿åº¦è‡³å°‘6ä½'
  }
  
  // éªŒè¯ç éªŒè¯
  if (requiresCaptcha.value && !captchaCode.value) {
    errors.captcha = 'è¯·è¾“å…¥éªŒè¯ç '
  }
  
  return {
    valid: Object.keys(errors).length === 0,
    errors
  }
}
```

### å¤šå› å­è®¤è¯æµç¨‹
```typescript
// è®¾ç½®MFAéªŒè¯
function setupMFAVerification(methods: MFAMethod[]) {
  mfaMethods.value = methods
  requiresMFA.value = true
  
  // ä¼˜å…ˆé€‰æ‹©å·²è®¾ç½®çš„æ–¹æ³•
  const preferredMethod = methods.find(m => m.verified) || methods[0]
  currentMFAStep.value = preferredMethod.type
  
  if (preferredMethod.type === 'sms') {
    sendSMSCode(preferredMethod.phoneNumber)
  } else if (preferredMethod.type === 'email') {
    sendEmailCode(preferredMethod.email)
  }
  
  showMFADialog()
}

// éªŒè¯MFAä»£ç 
async function verifyMFACode() {
  if (!mfaCode.value) {
    setError('è¯·è¾“å…¥éªŒè¯ç ')
    return
  }
  
  try {
    const response = await authStore.verifyMFA(mfaCode.value, currentMFAStep.value)
    
    if (response.success) {
      requiresMFA.value = false
      showSuccessMessage('éªŒè¯æˆåŠŸ')
      handleLoginSuccess(response)
    } else {
      setError('éªŒè¯ç é”™è¯¯ï¼Œè¯·é‡è¯•')
      mfaCode.value = ''
    }
  } catch (error) {
    setError('éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•')
  }
}

// å‘é€çŸ­ä¿¡éªŒè¯ç 
async function sendSMSCode(phoneNumber: string) {
  try {
    await authService.sendSMSVerification(phoneNumber)
    showSuccessMessage('éªŒè¯ç å·²å‘é€åˆ°æ‚¨çš„æ‰‹æœº')
    startCountdown()
  } catch (error) {
    showErrorMessage('å‘é€éªŒè¯ç å¤±è´¥ï¼Œè¯·é‡è¯•')
  }
}

// å€’è®¡æ—¶æ§åˆ¶
function startCountdown() {
  countdown.value = 60
  
  const timer = setInterval(() => {
    countdown.value--
    
    if (countdown.value <= 0) {
      clearInterval(timer)
      canResendCode.value = true
    }
  }, 1000)
}
```

### ç¬¬ä¸‰æ–¹ç™»å½•
```typescript
// OAuthç™»å½•
async function loginWithOAuth(provider: OAuthProvider) {
  oauthLoading.value[provider] = true
  
  try {
    // è·å–OAuthæˆæƒURL
    const authUrl = await authService.getOAuthAuthUrl(provider, {
      redirectUri: getOAuthRedirectUri(provider),
      state: generateRandomState()
    })
    
    // è·³è½¬åˆ°ç¬¬ä¸‰æ–¹æˆæƒé¡µé¢
    window.location.href = authUrl
    
  } catch (error) {
    showErrorMessage(`${provider} ç™»å½•å¤±è´¥: ${error.message}`)
  } finally {
    oauthLoading.value[provider] = false
  }
}

// å¤„ç†OAuthå›è°ƒ
async function handleOAuthCallback() {
  const urlParams = new URLSearchParams(window.location.search)
  const code = urlParams.get('code')
  const state = urlParams.get('state')
  const error = urlParams.get('error')
  
  if (error) {
    showErrorMessage(`æˆæƒå¤±è´¥: ${error}`)
    return
  }
  
  if (!code || !state) {
    showErrorMessage('æˆæƒå‚æ•°ç¼ºå¤±')
    return
  }
  
  try {
    const response = await authStore.handleOAuthCallback(code, state)
    
    if (response.success) {
      handleLoginSuccess(response)
    } else {
      handleLoginError(response)
    }
  } catch (error) {
    showErrorMessage('å¤„ç†æˆæƒå›è°ƒå¤±è´¥')
  }
}

// SSOç™»å½•
async function loginWithSSO(provider: SSOProvider) {
  try {
    const ssoUrl = await authService.getSSOAuthUrl(provider)
    window.location.href = ssoUrl
  } catch (error) {
    showErrorMessage(`SSOç™»å½•å¤±è´¥: ${error.message}`)
  }
}
```

### å®‰å…¨å¢å¼ºåŠŸèƒ½
```typescript
// è®¾å¤‡æŒ‡çº¹è¯†åˆ«
async function getDeviceInfo(): Promise<DeviceInfo> {
  const canvas = document.createElement('canvas')
  const ctx = canvas.getContext('2d')
  ctx.textBaseline = 'top'
  ctx.font = '14px Arial'
  ctx.fillText('Device fingerprint', 2, 2)
  
  return {
    userAgent: navigator.userAgent,
    platform: navigator.platform,
    browser: getBrowserInfo(),
    browserVersion: getBrowserVersion(),
    os: getOSInfo(),
    osVersion: getOSVersion(),
    screen: {
      width: screen.width,
      height: screen.height,
      colorDepth: screen.colorDepth,
      pixelDepth: screen.pixelDepth
    },
    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
    language: navigator.language,
    fingerprint: canvas.toDataURL()
  }
}

// æ£€æµ‹å¯ç–‘ç™»å½•
function detectSuspiciousLogin(deviceInfo: DeviceInfo): SecurityAlert[] {
  const alerts: SecurityAlert[] = []
  
  // æ£€æŸ¥æ–°è®¾å¤‡
  if (!deviceTrusted.value) {
    alerts.push({
      type: 'new_device',
      level: 'warning',
      message: 'æ£€æµ‹åˆ°æ–°è®¾å¤‡ç™»å½•',
      recommendation: 'å¦‚æœè¿™ä¸æ˜¯æ‚¨çš„æ“ä½œï¼Œè¯·ç«‹å³æ›´æ”¹å¯†ç '
    })
  }
  
  // æ£€æŸ¥å¼‚å¸¸æ—¶é—´
  const currentHour = new Date().getHours()
  if (currentHour < 6 || currentHour > 23) {
    alerts.push({
      type: 'unusual_time',
      level: 'info',
      message: 'æ£€æµ‹åˆ°å¼‚å¸¸æ—¶é—´ç™»å½•',
      recommendation: 'è¯·ç¡®è®¤è¿™æ˜¯æ‚¨æœ¬äººçš„æ“ä½œ'
    })
  }
  
  return alerts
}

// é£é™©è¯„åˆ†è®¡ç®—
function calculateRiskScore(factors: RiskFactor[]): number {
  let score = 0
  
  factors.forEach(factor => {
    switch (factor.type) {
      case 'new_device':
        score += factor.weight * 30
        break
      case 'new_location':
        score += factor.weight * 25
        break
      case 'failed_attempts':
        score += factor.weight * 20
        break
      case 'unusual_time':
        score += factor.weight * 10
        break
    }
  })
  
  return Math.min(score, 100)
}

// å®‰å…¨å»ºè®®
function generateSecurityRecommendations(riskScore: number): string[] {
  const recommendations = []
  
  if (riskScore > 70) {
    recommendations.push('å¼ºçƒˆå»ºè®®å¯ç”¨ä¸¤æ­¥éªŒè¯')
    recommendations.push('å»ºè®®ç«‹å³æ›´æ”¹å¯†ç ')
    recommendations.push('æ£€æŸ¥æœ€è¿‘çš„ç™»å½•æ´»åŠ¨')
  } else if (riskScore > 40) {
    recommendations.push('å»ºè®®å¯ç”¨ä¸¤æ­¥éªŒè¯')
    recommendations.push('å®šæœŸæ›´æ”¹å¯†ç ')
  } else {
    recommendations.push('ä¿æŒè‰¯å¥½çš„å®‰å…¨ä¹ æƒ¯')
  }
  
  return recommendations
}
```

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–
```typescript
// æ™ºèƒ½è¡¨å•å¡«å……
function setupSmartFormFilling() {
  // è®°ä½ä¸Šæ¬¡ç™»å½•çš„ç”¨æˆ·å
  const rememberedUsername = localStorage.getItem('lastUsername')
  if (rememberedUsername && rememberMe.value) {
    credentials.username = rememberedUsername
  }
  
  // è‡ªåŠ¨æ£€æµ‹ç™»å½•ç±»å‹
  watch(() => credentials.username, (newValue) => {
    if (newValue) {
      loginType.value = isValidEmail(newValue) ? 'email' : 'username'
    }
  })
}

// é”®ç›˜å¿«æ·é”®æ”¯æŒ
function setupKeyboardShortcuts() {
  document.addEventListener('keydown', (event) => {
    // Enteré”®ç™»å½•
    if (event.key === 'Enter' && !isLogging.value) {
      handleLogin()
    }
    
    // Escapeé”®æ¸…é™¤é”™è¯¯
    if (event.key === 'Escape') {
      clearErrors()
    }
    
    // Tabé”®åœ¨MFAè¾“å…¥æ¡†ä¹‹é—´åˆ‡æ¢
    if (event.key === 'Tab' && requiresMFA.value) {
      event.preventDefault()
      switchMFAMethod()
    }
  })
}

// å¯†ç å¼ºåº¦æ£€æµ‹
function checkPasswordStrength(password: string): PasswordStrength {
  let score = 0
  const feedback = []
  
  // é•¿åº¦æ£€æŸ¥
  if (password.length >= 8) score += 20
  else feedback.push('å¯†ç é•¿åº¦è‡³å°‘8ä½')
  
  // å¤æ‚åº¦æ£€æŸ¥
  if (/[a-z]/.test(password)) score += 15
  if (/[A-Z]/.test(password)) score += 15
  if (/[0-9]/.test(password)) score += 15
  if (/[^a-zA-Z0-9]/.test(password)) score += 20
  
  // å¸¸è§å¯†ç æ£€æŸ¥
  if (commonPasswords.includes(password.toLowerCase())) {
    score = 0
    feedback.push('å¯†ç è¿‡äºå¸¸è§ï¼Œè¯·ä½¿ç”¨æ›´å¤æ‚çš„å¯†ç ')
  }
  
  let strength: 'weak' | 'medium' | 'strong'
  if (score < 40) strength = 'weak'
  else if (score < 70) strength = 'medium'
  else strength = 'strong'
  
  return { score, strength, feedback }
}

// ç™»å½•çŠ¶æ€æŒä¹…åŒ–
function setupLoginPersistence() {
  // æ£€æŸ¥è‡ªåŠ¨ç™»å½•
  const autoLogin = localStorage.getItem('autoLogin')
  const savedToken = localStorage.getItem('authToken')
  
  if (autoLogin && savedToken) {
    authStore.validateToken(savedToken).then(isValid => {
      if (isValid) {
        router.push('/dashboard')
      } else {
        localStorage.removeItem('authToken')
        localStorage.removeItem('autoLogin')
      }
    })
  }
  
  // ç›‘å¬é¡µé¢å¯è§æ€§å˜åŒ–
  document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'visible' && isAuthenticated.value) {
      // é¡µé¢é‡æ–°å¯è§æ—¶æ£€æŸ¥tokenæœ‰æ•ˆæ€§
      authStore.validateCurrentSession()
    }
  })
}
```

## å“åº”å¼è®¾è®¡é€‚é…

### æ¡Œé¢ç«¯å¸ƒå±€ (â‰¥1200px)
- å·¦å³åˆ†æ å¸ƒå±€ï¼Œå·¦ä¾§å±•ç¤ºå¹³å°ç‰¹æ€§
- å³ä¾§å±…ä¸­çš„ç™»å½•è¡¨å•
- å®Œæ•´çš„åŠŸèƒ½å±•ç¤ºå’Œæç¤ºä¿¡æ¯

### å¹³æ¿ç«¯å¸ƒå±€ (768px-1199px)
- ç®€åŒ–çš„å·¦ä¾§å†…å®¹åŒºåŸŸ
- ç™»å½•è¡¨å•é€‚å½“æ”¾å¤§
- ä¿ç•™ä¸»è¦åŠŸèƒ½å…¥å£

### ç§»åŠ¨ç«¯å¸ƒå±€ (<768px)
- å…¨å±å•æ å¸ƒå±€
- é¡¶éƒ¨logoå’Œæ ‡é¢˜
- ç®€åŒ–çš„ç™»å½•é€‰é¡¹
- åº•éƒ¨é“¾æ¥èœå•

```typescript
// å“åº”å¼å¸ƒå±€é€‚é…
const isMobile = computed(() => screenWidth.value < 768)
const isTablet = computed(() => screenWidth.value >= 768 && screenWidth.value < 1200)

const loginContainerStyle = computed(() => ({
  flexDirection: isMobile.value ? 'column' : 'row',
  padding: isMobile.value ? '20px' : '0'
}))

const formWidth = computed(() => {
  if (isMobile.value) return '100%'
  if (isTablet.value) return '400px'
  return '450px'
})

const showLeftPanel = computed(() => !isMobile.value)
const showFeatureList = computed(() => !isMobile.value)
```

## å®‰å…¨è€ƒè™‘

### å¯†ç å®‰å…¨
```typescript
// å¯†ç åŠ å¯†ä¼ è¾“
function encryptPassword(password: string): string {
  // ä½¿ç”¨RSAå…¬é’¥åŠ å¯†å¯†ç 
  const publicKey = getServerPublicKey()
  return RSA.encrypt(password, publicKey)
}

// é˜²æ­¢å¯†ç æ³„éœ²
function clearPasswordFromMemory() {
  // æ¸…é™¤è¡¨å•ä¸­çš„å¯†ç 
  credentials.password = ''
  
  // æ¸…é™¤å¯èƒ½çš„å¯†ç ç¼“å­˜
  document.querySelectorAll('input[type="password"]').forEach(input => {
    input.value = ''
  })
}

// å¯†ç å¤æ‚åº¦éªŒè¯
function validatePasswordComplexity(password: string): boolean {
  const requirements = [
    /.{8,}/, // è‡³å°‘8ä½
    /[a-z]/, // å°å†™å­—æ¯
    /[A-Z]/, // å¤§å†™å­—æ¯  
    /[0-9]/, // æ•°å­—
    /[^a-zA-Z0-9]/ // ç‰¹æ®Šå­—ç¬¦
  ]
  
  return requirements.filter(req => req.test(password)).length >= 3
}
```

### é˜²æŠ¤æœºåˆ¶
```typescript
// CSRFé˜²æŠ¤
function setupCSRFProtection() {
  const token = document.querySelector('meta[name="csrf-token"]')?.getAttribute('content')
  if (token) {
    axios.defaults.headers.common['X-CSRF-TOKEN'] = token
  }
}

// æš´åŠ›ç ´è§£é˜²æŠ¤
function setupBruteForceProtection() {
  let attemptCount = 0
  let lastAttemptTime = 0
  
  return function rateLimit() {
    const now = Date.now()
    
    if (now - lastAttemptTime < 1000) { // 1ç§’å†…ä¸å…è®¸é‡å¤è¯·æ±‚
      throw new Error('è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•')
    }
    
    attemptCount++
    lastAttemptTime = now
    
    if (attemptCount > 5) {
      throw new Error('å°è¯•æ¬¡æ•°è¿‡å¤šï¼Œè¯·ç¨åå†è¯•')
    }
  }
}

// XSSé˜²æŠ¤
function sanitizeInput(input: string): string {
  return input
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#x27;')
    .replace(/\//g, '&#x2F;')
}

// å®‰å…¨æ—¥å¿—è®°å½•
async function logSecurityEvent(event: SecurityEvent) {
  await securityService.logEvent({
    type: event.type,
    severity: event.severity,
    details: event.details,
    userId: event.userId,
    ipAddress: getClientIPAddress(),
    userAgent: navigator.userAgent,
    timestamp: new Date().toISOString()
  })
}