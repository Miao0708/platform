# ä»£ç å·®å¼‚åˆ†æé¡µé¢åŸå‹è®¾è®¡

## é¡µé¢æ¦‚è¿°

ä»£ç å·®å¼‚åˆ†æé¡µé¢ç”¨äºæ˜¾ç¤ºå’Œåˆ†æä»£ç æ–‡ä»¶çš„å˜æ›´å·®å¼‚ï¼Œæä¾›å¯è§†åŒ–çš„ä»£ç å¯¹æ¯”ã€AIæ™ºèƒ½åˆ†æå’Œå˜æ›´å½±å“è¯„ä¼°åŠŸèƒ½ã€‚

## é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤´éƒ¨å¯¼èˆªæ                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¢åŒ…å±‘å¯¼èˆª: é¦–é¡µ > ä»£ç å·®å¼‚åˆ†æ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ å¯¼å…¥Git â”‚ â”‚ ä¸Šä¼ æ–‡ä»¶ â”‚ â”‚ åœ¨çº¿ç¼–è¾‘ â”‚ â”‚   è®¾ç½®   â”‚ â”‚  AIåˆ†æ  â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ–‡ä»¶æ ‘åˆ—è¡¨åŒºåŸŸ                    â”‚  å·®å¼‚å¯¹æ¯”åŒºåŸŸ                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ src/                     â”‚   â”‚ â”‚ æ–‡ä»¶ï¼šUserService.ts        â”‚ â”‚
â”‚ â”‚   ğŸ“ components/            â”‚   â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚ â”‚     ğŸ“„ Header.vue      [M]  â”‚   â”‚ â”‚ åŸå§‹ç‰ˆæœ¬    â”‚    ä¿®æ”¹ç‰ˆæœ¬     â”‚ â”‚
â”‚ â”‚     ğŸ“„ Footer.vue      [A]  â”‚   â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚ â”‚   ğŸ“ services/              â”‚   â”‚ â”‚ 1  import { â”‚ 1  import {    â”‚ â”‚
â”‚ â”‚     ğŸ“„ UserService.ts  [M]  â”‚   â”‚ â”‚ 2    User   â”‚ 2    User,     â”‚ â”‚
â”‚ â”‚     ğŸ“„ ApiClient.ts    [D]  â”‚   â”‚ â”‚ 3  } from   â”‚ 3    Profile   â”‚ â”‚
â”‚ â”‚   ğŸ“ utils/                 â”‚   â”‚ â”‚ 4  './types'â”‚ 4  } from      â”‚ â”‚
â”‚ â”‚     ğŸ“„ helpers.ts      [M]  â”‚   â”‚ â”‚ 5           â”‚ 5  './types'   â”‚ â”‚
â”‚ â”‚                             â”‚   â”‚ â”‚ 6  export   â”‚ 6             â”‚ â”‚
â”‚ â”‚ å›¾ä¾‹:                        â”‚   â”‚ â”‚ 7  class    â”‚ 7  export     â”‚ â”‚
â”‚ â”‚ [M] ä¿®æ”¹  [A] æ–°å¢  [D] åˆ é™¤ â”‚   â”‚ â”‚ 8  UserSer- â”‚ 8  class      â”‚ â”‚
â”‚ â”‚                             â”‚   â”‚ â”‚ 9  vice {   â”‚ 9  UserSer-   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ 10          â”‚ 10 vice {     â”‚ â”‚
â”‚                                   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AIåˆ†æç»“æœé¢æ¿ï¼ˆå¯æŠ˜å ï¼‰                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“Š å˜æ›´å½±å“åˆ†æ                  ğŸ” ä»£ç è´¨é‡æ£€æŸ¥                â”‚ â”‚
â”‚ â”‚ â€¢ ä¿®æ”¹æ–‡ä»¶: 3ä¸ª                  â€¢ ä»£ç å¤æ‚åº¦: å¢åŠ 12%         â”‚ â”‚
â”‚ â”‚ â€¢ æ–°å¢æ–‡ä»¶: 1ä¸ª                  â€¢ æµ‹è¯•è¦†ç›–ç‡: éœ€è¦æ–°å¢æµ‹è¯•     â”‚ â”‚
â”‚ â”‚ â€¢ åˆ é™¤æ–‡ä»¶: 1ä¸ª                  â€¢ æ½œåœ¨é—®é¢˜: 2ä¸ª              â”‚ â”‚
â”‚ â”‚ â€¢ å½±å“æ¨¡å—: UserManagement       â€¢ å»ºè®®é‡æ„: 1å¤„              â”‚ â”‚
â”‚ â”‚                                                               â”‚ â”‚
â”‚ â”‚ âš ï¸  é£é™©è¯„ä¼°                     ğŸ’¡ ä¼˜åŒ–å»ºè®®                   â”‚ â”‚
â”‚ â”‚ â€¢ é«˜é£é™©å˜æ›´: 1ä¸ª                â€¢ ä½¿ç”¨TypeScriptä¸¥æ ¼æ¨¡å¼     â”‚ â”‚
â”‚ â”‚ â€¢ APIå…¼å®¹æ€§: æ— å½±å“              â€¢ æ·»åŠ å•å…ƒæµ‹è¯•               â”‚ â”‚
â”‚ â”‚ â€¢ æ€§èƒ½å½±å“: è½»å¾®æå‡              â€¢ è€ƒè™‘ä»£ç åˆ†å‰²               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åŠŸèƒ½ç»„ä»¶

### 1. å·®å¼‚å¯¼å…¥åŒºåŸŸ

#### Gitä»“åº“å¯¼å…¥
- æ”¯æŒGit URLå¯¼å…¥
- åˆ†æ”¯é€‰æ‹©å’Œæäº¤è®°å½•æ¯”è¾ƒ
- æ”¯æŒç§æœ‰ä»“åº“è®¤è¯

#### æ–‡ä»¶ä¸Šä¼ 
- æ”¯æŒæ‹–æ‹½ä¸Šä¼ 
- æ‰¹é‡æ–‡ä»¶ä¸Šä¼ 
- å‹ç¼©åŒ…è§£å‹

#### åœ¨çº¿ç¼–è¾‘
- å†…ç½®ä»£ç ç¼–è¾‘å™¨
- è¯­æ³•é«˜äº®
- å®æ—¶é¢„è§ˆ

### 2. æ–‡ä»¶æ ‘å¯¼èˆª

#### æ–‡ä»¶çŠ¶æ€æ ‡è¯†
- [M] ä¿®æ”¹æ–‡ä»¶
- [A] æ–°å¢æ–‡ä»¶
- [D] åˆ é™¤æ–‡ä»¶
- [R] é‡å‘½åæ–‡ä»¶

#### ç­›é€‰åŠŸèƒ½
- æŒ‰æ–‡ä»¶ç±»å‹ç­›é€‰
- æŒ‰å˜æ›´çŠ¶æ€ç­›é€‰
- æœç´¢æ–‡ä»¶å

### 3. å·®å¼‚å¯¹æ¯”è§†å›¾

#### å¹¶æ’å¯¹æ¯”æ¨¡å¼
- å·¦å³åˆ†å±æ˜¾ç¤º
- è¡Œå·å¯¹é½
- å˜æ›´é«˜äº®æ˜¾ç¤º

#### ç»Ÿä¸€å·®å¼‚æ¨¡å¼
- ä¸Šä¸‹æ–‡æ˜¾ç¤º
- æŠ˜å æœªå˜æ›´åŒºåŸŸ
- å·®å¼‚ç»Ÿè®¡ä¿¡æ¯

#### äº¤äº’åŠŸèƒ½
- æ»šåŠ¨åŒæ­¥
- è·³è½¬åˆ°ä¸‹ä¸€ä¸ªå·®å¼‚
- å±•å¼€/æŠ˜å ä»£ç å—

### 4. AIåˆ†æé¢æ¿

#### å˜æ›´å½±å“åˆ†æ
- ä¿®æ”¹æ–‡ä»¶ç»Ÿè®¡
- å½±å“æ¨¡å—è¯†åˆ«
- ä¾èµ–å…³ç³»åˆ†æ

#### ä»£ç è´¨é‡æ£€æŸ¥
- å¤æ‚åº¦åˆ†æ
- ä»£ç è§„èŒƒæ£€æŸ¥
- å®‰å…¨æ¼æ´æ‰«æ

#### é£é™©è¯„ä¼°
- å˜æ›´é£é™©ç­‰çº§
- å…¼å®¹æ€§æ£€æŸ¥
- æ€§èƒ½å½±å“è¯„ä¼°

## æ•°æ®æ¨¡å‹

### ä»£ç å·®å¼‚å®ä½“

```typescript
interface CodeDiff {
  id: string;                    // å·®å¼‚åˆ†æID
  name: string;                  // åˆ†æåç§°
  type: DiffType;               // å·®å¼‚ç±»å‹
  source: DiffSource;           // æ•°æ®æºä¿¡æ¯
  files: FileDiff[];            // æ–‡ä»¶å·®å¼‚åˆ—è¡¨
  statistics: DiffStatistics;   // å·®å¼‚ç»Ÿè®¡
  aiAnalysis?: AIDiffAnalysis;  // AIåˆ†æç»“æœ
  createdAt: Date;              // åˆ›å»ºæ—¶é—´
  updatedAt: Date;              // æ›´æ–°æ—¶é—´
  createdBy: string;            // åˆ›å»ºè€…
}

enum DiffType {
  GIT_COMMIT = 'git_commit',     // Gitæäº¤å¯¹æ¯”
  FILE_UPLOAD = 'file_upload',   // æ–‡ä»¶ä¸Šä¼ å¯¹æ¯”
  MANUAL_EDIT = 'manual_edit'    // æ‰‹åŠ¨ç¼–è¾‘å¯¹æ¯”
}

interface DiffSource {
  type: DiffType;
  gitRepo?: {
    url: string;
    branch: string;
    fromCommit: string;
    toCommit: string;
  };
  files?: {
    originalFiles: FileInfo[];
    modifiedFiles: FileInfo[];
  };
}

interface FileDiff {
  path: string;                  // æ–‡ä»¶è·¯å¾„
  status: FileStatus;            // æ–‡ä»¶çŠ¶æ€
  language: string;              // ç¼–ç¨‹è¯­è¨€
  originalContent?: string;      // åŸå§‹å†…å®¹
  modifiedContent?: string;      // ä¿®æ”¹åå†…å®¹
  chunks: DiffChunk[];           // å·®å¼‚å—
  statistics: FileStatistics;   // æ–‡ä»¶ç»Ÿè®¡
}

enum FileStatus {
  ADDED = 'added',               // æ–°å¢
  MODIFIED = 'modified',         // ä¿®æ”¹
  DELETED = 'deleted',           // åˆ é™¤
  RENAMED = 'renamed'            // é‡å‘½å
}

interface DiffChunk {
  originalStart: number;         // åŸå§‹æ–‡ä»¶èµ·å§‹è¡Œ
  originalLines: number;         // åŸå§‹æ–‡ä»¶è¡Œæ•°
  modifiedStart: number;         // ä¿®æ”¹æ–‡ä»¶èµ·å§‹è¡Œ
  modifiedLines: number;         // ä¿®æ”¹æ–‡ä»¶è¡Œæ•°
  content: string;               // å·®å¼‚å†…å®¹
  type: 'context' | 'add' | 'delete'; // è¡Œç±»å‹
}

interface DiffStatistics {
  totalFiles: number;            // æ€»æ–‡ä»¶æ•°
  addedFiles: number;            // æ–°å¢æ–‡ä»¶æ•°
  modifiedFiles: number;         // ä¿®æ”¹æ–‡ä»¶æ•°
  deletedFiles: number;          // åˆ é™¤æ–‡ä»¶æ•°
  addedLines: number;            // æ–°å¢è¡Œæ•°
  deletedLines: number;          // åˆ é™¤è¡Œæ•°
  languages: LanguageStats[];    // è¯­è¨€ç»Ÿè®¡
}

interface FileStatistics {
  addedLines: number;
  deletedLines: number;
  complexity: number;            // å¤æ‚åº¦å˜åŒ–
}

interface LanguageStats {
  language: string;
  files: number;
  addedLines: number;
  deletedLines: number;
}

interface AIDiffAnalysis {
  impactAnalysis: ImpactAnalysis;
  qualityAnalysis: QualityAnalysis;
  riskAssessment: RiskAssessment;
  suggestions: Suggestion[];
  complexity: ComplexityAnalysis;
}

interface ImpactAnalysis {
  affectedModules: string[];     // å½±å“çš„æ¨¡å—
  dependencyChanges: DependencyChange[]; // ä¾èµ–å˜æ›´
  apiChanges: APIChange[];       // APIå˜æ›´
  performanceImpact: 'positive' | 'negative' | 'neutral'; // æ€§èƒ½å½±å“
}

interface QualityAnalysis {
  codeComplexity: {
    before: number;
    after: number;
    change: number;
  };
  testCoverage: {
    current: number;
    required: number;
    missing: string[];
  };
  codeIssues: CodeIssue[];
  refactoringSuggestions: RefactoringSuggestion[];
}

interface RiskAssessment {
  overallRisk: 'low' | 'medium' | 'high' | 'critical';
  riskFactors: RiskFactor[];
  breakingChanges: BreakingChange[];
  compatibilityIssues: CompatibilityIssue[];
}

interface CodeIssue {
  severity: 'error' | 'warning' | 'info';
  message: string;
  file: string;
  line: number;
  rule: string;
}

interface Suggestion {
  type: 'performance' | 'security' | 'maintainability' | 'testing';
  title: string;
  description: string;
  priority: 'high' | 'medium' | 'low';
  effort: 'small' | 'medium' | 'large';
}
```

### åˆ†æé…ç½®

```typescript
interface DiffAnalysisConfig {
  ignorePatterns: string[];      // å¿½ç•¥æ¨¡å¼
  languageSettings: LanguageSetting[];
  aiAnalysisEnabled: boolean;
  qualityRules: QualityRule[];
  riskThresholds: RiskThreshold[];
}

interface LanguageSetting {
  language: string;
  enabled: boolean;
  syntaxHighlight: boolean;
  qualityRules: string[];
}

interface QualityRule {
  id: string;
  name: string;
  enabled: boolean;
  severity: 'error' | 'warning' | 'info';
  pattern?: string;
}

interface RiskThreshold {
  metric: string;
  warningThreshold: number;
  errorThreshold: number;
}
```

## çŠ¶æ€ç®¡ç†

### Storeå®šä¹‰

```typescript
interface CodeDiffState {
  // å½“å‰å·®å¼‚åˆ†æ
  currentDiff: CodeDiff | null;
  loading: boolean;
  
  // æ–‡ä»¶æ ‘çŠ¶æ€
  fileTree: FileTreeNode[];
  selectedFile: string | null;
  expandedFolders: Set<string>;
  
  // è§†å›¾çŠ¶æ€
  viewMode: 'split' | 'unified';
  showLineNumbers: boolean;
  showWhitespace: boolean;
  wordWrap: boolean;
  
  // AIåˆ†æçŠ¶æ€
  aiAnalysisVisible: boolean;
  analyzing: boolean;
  analysisResult: AIDiffAnalysis | null;
  
  // ç­›é€‰çŠ¶æ€
  fileFilter: {
    status: FileStatus[];
    language: string[];
    search: string;
  };
  
  // é…ç½®
  config: DiffAnalysisConfig;
}

interface CodeDiffActions {
  // å¯¼å…¥æ“ä½œ
  importFromGit: (gitInfo: GitImportInfo) => Promise<void>;
  uploadFiles: (files: File[]) => Promise<void>;
  createManualDiff: (original: string, modified: string) => Promise<void>;
  
  // æ–‡ä»¶æ“ä½œ
  selectFile: (filePath: string) => void;
  toggleFolder: (folderPath: string) => void;
  navigateToNextDiff: () => void;
  navigateToPrevDiff: () => void;
  
  // è§†å›¾æ§åˆ¶
  setViewMode: (mode: 'split' | 'unified') => void;
  toggleLineNumbers: () => void;
  toggleWhitespace: () => void;
  toggleWordWrap: () => void;
  
  // AIåˆ†æ
  runAIAnalysis: () => Promise<void>;
  toggleAIAnalysisPanel: () => void;
  
  // ç­›é€‰æ“ä½œ
  updateFileFilter: (filter: Partial<FileFilter>) => void;
  resetFileFilter: () => void;
  
  // é…ç½®ç®¡ç†
  updateConfig: (config: Partial<DiffAnalysisConfig>) => void;
  
  // å¯¼å‡ºæ“ä½œ
  exportDiff: (format: 'html' | 'pdf' | 'json') => Promise<void>;
}

interface FileTreeNode {
  path: string;
  name: string;
  type: 'file' | 'folder';
  status?: FileStatus;
  children?: FileTreeNode[];
  statistics?: FileStatistics;
}
```

## é¡µé¢äº¤äº’é€»è¾‘

### 1. å·®å¼‚å¯¼å…¥æµç¨‹

```typescript
// Gitä»“åº“å¯¼å…¥
const handleGitImport = async (gitInfo: GitImportInfo) => {
  try {
    loading.value = true;
    showProgress('æ­£åœ¨å…‹éš†ä»£ç ä»“åº“...');
    
    const diff = await importFromGit(gitInfo);
    currentDiff.value = diff;
    
    // æ„å»ºæ–‡ä»¶æ ‘
    buildFileTree(diff.files);
    
    // è‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªä¿®æ”¹çš„æ–‡ä»¶
    selectFirstModifiedFile();
    
    showSuccess('ä»£ç å¯¼å…¥æˆåŠŸ');
  } catch (error) {
    showError('å¯¼å…¥å¤±è´¥ï¼š' + error.message);
  } finally {
    loading.value = false;
    hideProgress();
  }
};

// æ–‡ä»¶ä¸Šä¼ å¤„ç†
const handleFileUpload = async (files: File[]) => {
  try {
    loading.value = true;
    showProgress('æ­£åœ¨åˆ†ææ–‡ä»¶å·®å¼‚...');
    
    const diff = await uploadFiles(files);
    currentDiff.value = diff;
    
    buildFileTree(diff.files);
    selectFirstModifiedFile();
    
    showSuccess('æ–‡ä»¶ä¸Šä¼ æˆåŠŸ');
  } catch (error) {
    showError('ä¸Šä¼ å¤±è´¥ï¼š' + error.message);
  } finally {
    loading.value = false;
    hideProgress();
  }
};
```

### 2. æ–‡ä»¶å¯¼èˆªé€»è¾‘

```typescript
// æ–‡ä»¶é€‰æ‹©
const handleFileSelect = (filePath: string) => {
  selectFile(filePath);
  
  // æ›´æ–°å·®å¼‚è§†å›¾
  updateDiffView(filePath);
  
  // è®°å½•è®¿é—®å†å²
  addToHistory(filePath);
};

// æ–‡ä»¶å¤¹å±•å¼€/æŠ˜å 
const handleFolderToggle = (folderPath: string) => {
  toggleFolder(folderPath);
  
  // ä¿å­˜å±•å¼€çŠ¶æ€åˆ°æœ¬åœ°å­˜å‚¨
  saveExpandedState();
};

// å·®å¼‚å¯¼èˆª
const handleNavigateToDiff = (direction: 'next' | 'prev') => {
  const currentLine = getCurrentLine();
  const nextDiff = findNextDiff(currentLine, direction);
  
  if (nextDiff) {
    scrollToLine(nextDiff.line);
    highlightDiff(nextDiff);
  } else {
    // åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªæ–‡ä»¶
    const nextFile = getNextFile(direction);
    if (nextFile) {
      selectFile(nextFile.path);
    }
  }
};
```

### 3. å·®å¼‚è§†å›¾äº¤äº’

```typescript
// è§†å›¾æ¨¡å¼åˆ‡æ¢
const handleViewModeChange = (mode: 'split' | 'unified') => {
  setViewMode(mode);
  
  // é‡æ–°æ¸²æŸ“å·®å¼‚è§†å›¾
  rerenderDiffView();
  
  // ä¿æŒå½“å‰æ»šåŠ¨ä½ç½®
  maintainScrollPosition();
};

// è¡Œç‚¹å‡»å¤„ç†
const handleLineClick = (lineNumber: number, side: 'left' | 'right') => {
  // åŒæ­¥æ»šåŠ¨åˆ°å¯¹åº”è¡Œ
  syncScrollPosition(lineNumber, side);
  
  // æ˜¾ç¤ºè¡Œä¿¡æ¯
  showLineInfo(lineNumber, side);
};

// ä»£ç æŠ˜å /å±•å¼€
const handleCodeFolding = (startLine: number, endLine: number) => {
  if (isCodeFolded(startLine, endLine)) {
    expandCode(startLine, endLine);
  } else {
    foldCode(startLine, endLine);
  }
  
  updateFoldingState();
};
```

### 4. AIåˆ†æé›†æˆ

```typescript
// è§¦å‘AIåˆ†æ
const handleAIAnalysis = async () => {
  if (!currentDiff.value) return;
  
  try {
    analyzing.value = true;
    showProgress('AIæ­£åœ¨åˆ†æä»£ç å·®å¼‚...');
    
    const analysis = await runAIAnalysis();
    analysisResult.value = analysis;
    
    // æ˜¾ç¤ºåˆ†æç»“æœ
    aiAnalysisVisible.value = true;
    
    // åœ¨ä»£ç ä¸­æ ‡è®°é—®é¢˜
    highlightCodeIssues(analysis.qualityAnalysis.codeIssues);
    
    showSuccess('AIåˆ†æå®Œæˆ');
  } catch (error) {
    showError('AIåˆ†æå¤±è´¥ï¼š' + error.message);
  } finally {
    analyzing.value = false;
    hideProgress();
  }
};

// åˆ†æç»“æœäº¤äº’
const handleAnalysisResultClick = (issue: CodeIssue) => {
  // è·³è½¬åˆ°é—®é¢˜æ‰€åœ¨è¡Œ
  selectFile(issue.file);
  scrollToLine(issue.line);
  highlightLine(issue.line);
  
  // æ˜¾ç¤ºé—®é¢˜è¯¦æƒ…
  showIssueDetails(issue);
};
```

### 5. ç­›é€‰å’Œæœç´¢

```typescript
// æ–‡ä»¶ç­›é€‰
const handleFileFilter = (filter: Partial<FileFilter>) => {
  updateFileFilter(filter);
  
  // æ›´æ–°æ–‡ä»¶æ ‘æ˜¾ç¤º
  updateFileTreeVisibility();
  
  // å¦‚æœå½“å‰é€‰ä¸­æ–‡ä»¶è¢«ç­›é€‰æ‰ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªå¯è§æ–‡ä»¶
  if (!isCurrentFileVisible()) {
    selectFirstVisibleFile();
  }
};

// æ–‡ä»¶æœç´¢
const handleFileSearch = debounce((keyword: string) => {
  updateFileFilter({ search: keyword });
  updateFileTreeVisibility();
}, 300);
```

## å“åº”å¼è®¾è®¡

### æ¡Œé¢ç«¯ (â‰¥1200px)
- ä¸‰æ å¸ƒå±€ï¼šæ–‡ä»¶æ ‘ + å·®å¼‚è§†å›¾ + AIåˆ†æé¢æ¿
- æ–‡ä»¶æ ‘å¯è°ƒæ•´å®½åº¦
- å·®å¼‚è§†å›¾æ”¯æŒå¹¶æ’å’Œç»Ÿä¸€æ¨¡å¼

### å¹³æ¿ç«¯ (768px-1199px)
- ä¸¤æ å¸ƒå±€ï¼šæ–‡ä»¶æ ‘æŠ˜å  + å·®å¼‚è§†å›¾
- AIåˆ†æé¢æ¿ä»¥æŠ½å±‰å½¢å¼æ˜¾ç¤º
- ç®€åŒ–å·¥å…·æ é€‰é¡¹

### ç§»åŠ¨ç«¯ (<768px)
- å•æ å¸ƒå±€ï¼Œåˆ†é¡µæ˜¾ç¤º
- æ–‡ä»¶æ ‘ã€å·®å¼‚è§†å›¾ã€åˆ†æç»“æœåˆ†åˆ«å æ®å…¨å±
- åº•éƒ¨æ ‡ç­¾é¡µå¯¼èˆª

## æ€§èƒ½ä¼˜åŒ–

### 1. è™šæ‹Ÿæ»šåŠ¨

```typescript
// å¤§æ–‡ä»¶å·®å¼‚è™šæ‹Ÿæ»šåŠ¨
const virtualScrollConfig = {
  itemHeight: 20,           // æ¯è¡Œé«˜åº¦
  buffer: 50,              // ç¼“å†²åŒºè¡Œæ•°
  threshold: 1000          // å¯ç”¨è™šæ‹Ÿæ»šåŠ¨çš„è¡Œæ•°é˜ˆå€¼
};

// æŒ‰éœ€åŠ è½½æ–‡ä»¶å†…å®¹
const loadFileContent = async (filePath: string) => {
  if (!contentCache.has(filePath)) {
    const content = await fetchFileContent(filePath);
    contentCache.set(filePath, content);
  }
  return contentCache.get(filePath);
};
```

### 2. å·®å¼‚è®¡ç®—ä¼˜åŒ–

```typescript
// Web Workerè®¡ç®—å·®å¼‚
const calculateDiff = async (original: string, modified: string) => {
  return new Promise((resolve) => {
    const worker = new Worker('/workers/diff-worker.js');
    worker.postMessage({ original, modified });
    worker.onmessage = (e) => {
      resolve(e.data.diff);
      worker.terminate();
    };
  });
};

// å¢é‡æ›´æ–°å·®å¼‚
const updateDiffIncremental = (changes: Change[]) => {
  const existingDiff = currentDiff.value;
  const updatedDiff = applyChangesToDiff(existingDiff, changes);
  currentDiff.value = updatedDiff;
};
```

### 3. å†…å­˜ç®¡ç†

```typescript
// æ–‡ä»¶å†…å®¹ç¼“å­˜ç®¡ç†
class ContentCache {
  private cache = new Map<string, string>();
  private maxSize = 50; // æœ€å¤§ç¼“å­˜æ–‡ä»¶æ•°
  
  set(key: string, content: string) {
    if (this.cache.size >= this.maxSize) {
      // åˆ é™¤æœ€æ—§çš„ç¼“å­˜
      const firstKey = this.cache.keys().next().value;
      this.cache.delete(firstKey);
    }
    this.cache.set(key, content);
  }
  
  get(key: string): string | undefined {
    return this.cache.get(key);
  }
  
  clear() {
    this.cache.clear();
  }
}
```

## å®‰å…¨è€ƒè™‘

### 1. æ–‡ä»¶ä¸Šä¼ å®‰å…¨

```typescript
// æ–‡ä»¶ç±»å‹æ£€æŸ¥
const validateFileType = (file: File): boolean => {
  const allowedTypes = ['.js', '.ts', '.vue', '.py', '.java', '.cpp'];
  const extension = file.name.toLowerCase().substring(file.name.lastIndexOf('.'));
  return allowedTypes.includes(extension);
};

// æ–‡ä»¶å¤§å°é™åˆ¶
const validateFileSize = (file: File): boolean => {
  const maxSize = 10 * 1024 * 1024; // 10MB
  return file.size <= maxSize;
};

// æ–‡ä»¶å†…å®¹å®‰å…¨æ£€æŸ¥
const scanFileContent = async (content: string): Promise<SecurityIssue[]> => {
  const issues: SecurityIssue[] = [];
  
  // æ£€æŸ¥æ•æ„Ÿä¿¡æ¯
  if (containsCredentials(content)) {
    issues.push({
      type: 'credentials',
      message: 'æ£€æµ‹åˆ°å¯èƒ½çš„å‡­æ®ä¿¡æ¯',
      severity: 'high'
    });
  }
  
  return issues;
};
```

### 2. Gitä»“åº“å®‰å…¨

```typescript
// Git URLéªŒè¯
const validateGitUrl = (url: string): boolean => {
  const gitUrlPattern = /^(https?:\/\/|git@)[\w\.-]+[:\w\.-\/]+\.git$/;
  return gitUrlPattern.test(url);
};

// ç§æœ‰ä»“åº“è®¤è¯
const authenticateGitRepo = async (url: string, credentials: GitCredentials) => {
  // ä½¿ç”¨å®‰å…¨çš„æ–¹å¼å¤„ç†è®¤è¯ä¿¡æ¯
  const encryptedCredentials = await encryptCredentials(credentials);
  return await gitClient.authenticate(url, encryptedCredentials);
};
```

## ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### 1. åŠ è½½çŠ¶æ€

```typescript
// åˆ†é˜¶æ®µåŠ è½½åé¦ˆ
const showLoadingStages = (stages: string[]) => {
  let currentStage = 0;
  
  const updateStage = () => {
    if (currentStage < stages.length) {
      showProgress(stages[currentStage]);
      currentStage++;
      setTimeout(updateStage, 1000);
    }
  };
  
  updateStage();
};

// å¯¼å…¥è¿›åº¦ç¤ºä¾‹
const gitImportStages = [
  'æ­£åœ¨è¿æ¥Gitä»“åº“...',
  'æ­£åœ¨ä¸‹è½½ä»£ç ...',
  'æ­£åœ¨è®¡ç®—å·®å¼‚...',
  'æ­£åœ¨ç”Ÿæˆåˆ†ææŠ¥å‘Š...'
];
```

### 2. å¿«æ·é”®æ”¯æŒ

```typescript
// é”®ç›˜å¿«æ·é”®
const keyboardShortcuts = {
  'Ctrl+F': () => showSearchDialog(),        // æœç´¢
  'F3': () => navigateToNextDiff(),          // ä¸‹ä¸€ä¸ªå·®å¼‚
  'Shift+F3': () => navigateToPrevDiff(),    // ä¸Šä¸€ä¸ªå·®å¼‚
  'Ctrl+G': () => showGoToLineDialog(),      // è·³è½¬åˆ°è¡Œ
  'Ctrl+D': () => toggleAIAnalysisPanel(),   // åˆ‡æ¢AIé¢æ¿
  'Escape': () => closeCurrentPanel()       // å…³é—­é¢æ¿
};
```

### 3. è‡ªåŠ¨ä¿å­˜å’Œæ¢å¤

```typescript
// è‡ªåŠ¨ä¿å­˜åˆ†æçŠ¶æ€
const autoSaveState = debounce(() => {
  const state = {
    currentDiff: currentDiff.value,
    selectedFile: selectedFile.value,
    viewMode: viewMode.value,
    fileFilter: fileFilter.value
  };
  
  localStorage.setItem('codeDiffState', JSON.stringify(state));
}, 1000);

// æ¢å¤ä¸Šæ¬¡çŠ¶æ€
const restoreState = () => {
  const savedState = localStorage.getItem('codeDiffState');
  if (savedState) {
    const state = JSON.parse(savedState);
    // æ¢å¤çŠ¶æ€
    restoreAnalysisState(state);
  }
};
``` 