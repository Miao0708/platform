# ä»£ç è¯„å®¡é¡µé¢åŸå‹è®¾è®¡

## é¡µé¢æ¦‚è¿°

ä»£ç è¯„å®¡é¡µé¢æä¾›å…¨é¢çš„ä»£ç å®¡æŸ¥åŠŸèƒ½ï¼Œæ”¯æŒå¤šäººåä½œè¯„å®¡ã€AIè¾…åŠ©åˆ†æã€è¯„å®¡æµç¨‹ç®¡ç†å’Œä»£ç è´¨é‡æ£€æŸ¥ã€‚

## é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¤´éƒ¨å¯¼èˆªæ                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¢åŒ…å±‘å¯¼èˆª: é¦–é¡µ > ä»£ç è¯„å®¡                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  æ–°å»ºè¯„å®¡  â”‚ â”‚  æˆ‘çš„è¯„å®¡  â”‚ â”‚  å¾…å®¡æ ¸   â”‚ â”‚  å·²å®Œæˆ   â”‚ â”‚   è®¾ç½®   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¯„å®¡åˆ—è¡¨åŒºåŸŸ                    â”‚  è¯„å®¡è¯¦æƒ…åŒºåŸŸ                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ PR-001 ç”¨æˆ·è®¤è¯åŠŸèƒ½æ”¹è¿›   â”‚ â”‚ â”‚ è¯„å®¡è¯¦æƒ…: PR-001            â”‚ â”‚
â”‚ â”‚    å¼ ä¸‰ â†’ main             â”‚ â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚ â”‚    â° 2å°æ—¶å‰              â”‚ â”‚ â”‚ æ ‡é¢˜: ç”¨æˆ·è®¤è¯åŠŸèƒ½æ”¹è¿›        â”‚ â”‚
â”‚ â”‚    ğŸ‘¥ 3äººå‚ä¸              â”‚ â”‚ â”‚ åˆ†æ”¯: feature/auth â†’ main    â”‚ â”‚
â”‚ â”‚    âœ… 2ä¸ªæ‰¹å‡†              â”‚ â”‚ â”‚ ä½œè€…: å¼ ä¸‰                   â”‚ â”‚
â”‚ â”‚    âš ï¸ 1ä¸ªé—®é¢˜              â”‚ â”‚ â”‚ åˆ›å»ºæ—¶é—´: 2024-01-15         â”‚ â”‚
â”‚ â”‚                            â”‚ â”‚ â”‚                             â”‚ â”‚
â”‚ â”‚ ğŸ“ PR-002 APIæ¥å£ä¼˜åŒ–       â”‚ â”‚ â”‚ æè¿°: ä¼˜åŒ–ç”¨æˆ·è®¤è¯æµç¨‹ï¼Œ      â”‚ â”‚
â”‚ â”‚    æå›› â†’ main             â”‚ â”‚ â”‚ å¢å¼ºå®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒ...       â”‚ â”‚
â”‚ â”‚    â° 5å°æ—¶å‰              â”‚ â”‚ â”‚                             â”‚ â”‚
â”‚ â”‚    ğŸ‘¥ 2äººå‚ä¸              â”‚ â”‚ â”‚ ğŸ“Š AIåˆ†ææŠ¥å‘Š               â”‚ â”‚
â”‚ â”‚    ğŸ”„ ç­‰å¾…è¯„å®¡             â”‚ â”‚ â”‚ â€¢ ä»£ç è´¨é‡: è‰¯å¥½ âœ…          â”‚ â”‚
â”‚ â”‚                            â”‚ â”‚ â”‚ â€¢ å®‰å…¨æ€§: å·²é€šè¿‡ âœ…          â”‚ â”‚
â”‚ â”‚ ğŸ“ PR-003 å‰ç«¯ç»„ä»¶é‡æ„      â”‚ â”‚ â”‚ â€¢ æ€§èƒ½å½±å“: æ— å½±å“ âšª       â”‚ â”‚
â”‚ â”‚    ç‹äº” â†’ develop          â”‚ â”‚ â”‚ â€¢ æµ‹è¯•è¦†ç›–: 85% âš ï¸          â”‚ â”‚
â”‚ â”‚    â° 1å¤©å‰               â”‚ â”‚ â”‚                             â”‚ â”‚
â”‚ â”‚    ğŸ‘¥ 1äººå‚ä¸              â”‚ â”‚ â”‚ ğŸ—‚ï¸  æ–‡ä»¶å˜æ›´ (5ä¸ªæ–‡ä»¶)        â”‚ â”‚
â”‚ â”‚    âŒ 1ä¸ªæ‹’ç»              â”‚ â”‚ â”‚ ğŸ“„ src/auth/LoginForm.vue   â”‚ â”‚
â”‚ â”‚                            â”‚ â”‚ â”‚ ğŸ“„ src/services/AuthService â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ ğŸ“„ src/utils/validators.ts â”‚ â”‚
â”‚ â”‚ â”‚ ç­›é€‰å™¨                  â”‚ â”‚ â”‚ ğŸ“„ tests/auth.spec.ts      â”‚ â”‚
â”‚ â”‚ â”‚ â˜‘ï¸ å¾…æˆ‘è¯„å®¡             â”‚ â”‚ â”‚ ğŸ“„ docs/api.md             â”‚ â”‚
â”‚ â”‚ â”‚ â˜ æˆ‘åˆ›å»ºçš„              â”‚ â”‚ â”‚                             â”‚ â”‚
â”‚ â”‚ â”‚ â˜ å·²æ‰¹å‡†                â”‚ â”‚ â”‚ ğŸ“ è¯„å®¡æ„è§ (3æ¡)            â”‚ â”‚
â”‚ â”‚ â”‚ â˜ éœ€è¦ä¿®æ”¹              â”‚ â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ [æŸ¥çœ‹ä»£ç ] [æ·»åŠ è¯„è®º]        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä»£ç å®¡æŸ¥åŒºåŸŸï¼ˆå…¨å±æ˜¾ç¤ºæ—¶ï¼‰                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ–‡ä»¶: src/auth/LoginForm.vue    [å¹¶æ’è§†å›¾] [ç»Ÿä¸€è§†å›¾] [AIå»ºè®®]   â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚ åŸå§‹ä»£ç                     â”‚     ä¿®æ”¹åä»£ç                    â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚  1  <template>             â”‚  1  <template>                  â”‚ â”‚
â”‚ â”‚  2    <form @submit="      â”‚  2    <form @submit.prevent="   â”‚ â”‚
â”‚ â”‚  3      handleLogin">      â”‚  3      handleLogin">           â”‚ â”‚
â”‚ â”‚  4      <input             â”‚  4      <input                  â”‚ â”‚
â”‚ â”‚  5        v-model="form.   â”‚  5        v-model="form.       â”‚ â”‚
â”‚ â”‚ ğŸ’¬ æå››: å»ºè®®æ·»åŠ é˜²æŠ–å¤„ç†     â”‚ ğŸ’¬ æå››: å·²æ”¹è¿›,æ·»åŠ äº†prevent â”‚ â”‚
â”‚ â”‚     â° 2å°æ—¶å‰             â”‚     â° 1å°æ—¶å‰                  â”‚ â”‚
â”‚ â”‚     [å›å¤] [å·²è§£å†³]         â”‚     [å›å¤] [å·²è§£å†³]             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åŠŸèƒ½ç»„ä»¶

### 1. è¯„å®¡æ¦‚è§ˆåŒºåŸŸ

#### çŠ¶æ€æ ‡ç­¾
- å¾…è¯„å®¡ï¼šæ–°æäº¤çš„è¯„å®¡è¯·æ±‚
- è¿›è¡Œä¸­ï¼šæ­£åœ¨è¯„å®¡è¿‡ç¨‹ä¸­
- éœ€è¦ä¿®æ”¹ï¼šå‘ç°é—®é¢˜ï¼Œéœ€è¦ä¿®æ”¹
- å·²æ‰¹å‡†ï¼šè¯„å®¡é€šè¿‡
- å·²åˆå¹¶ï¼šä»£ç å·²åˆå¹¶åˆ°ç›®æ ‡åˆ†æ”¯

#### ç­›é€‰åŠŸèƒ½
- æŒ‰çŠ¶æ€ç­›é€‰
- æŒ‰è¯„å®¡è€…ç­›é€‰
- æŒ‰åˆ›å»ºè€…ç­›é€‰
- æŒ‰æ—¶é—´èŒƒå›´ç­›é€‰
- æŒ‰ä¼˜å…ˆçº§ç­›é€‰

### 2. è¯„å®¡åˆ—è¡¨

#### åˆ—è¡¨ä¿¡æ¯
- è¯„å®¡æ ‡é¢˜å’Œæè¿°
- æºåˆ†æ”¯ â†’ ç›®æ ‡åˆ†æ”¯
- åˆ›å»ºè€…å’Œæ—¶é—´
- å‚ä¸è¯„å®¡äººæ•°
- è¯„å®¡çŠ¶æ€å’Œè¿›åº¦
- AIåˆ†ææ‘˜è¦

#### å¿«é€Ÿæ“ä½œ
- å¿«é€Ÿæ‰¹å‡†/æ‹’ç»
- æ·»åŠ è¯„å®¡è€…
- è®¾ç½®ä¼˜å…ˆçº§
- æ ‡è®°é‡è¦

### 3. è¯„å®¡è¯¦æƒ…é¢æ¿

#### åŸºæœ¬ä¿¡æ¯
- å®Œæ•´çš„PRæè¿°
- åˆ†æ”¯ä¿¡æ¯å’Œæäº¤å†å²
- æ–‡ä»¶å˜æ›´ç»Ÿè®¡
- è¯„å®¡è€…åˆ—è¡¨å’ŒçŠ¶æ€

#### AIåˆ†ææ‘˜è¦
- ä»£ç è´¨é‡è¯„åˆ†
- å®‰å…¨æ€§æ£€æŸ¥ç»“æœ
- æ€§èƒ½å½±å“åˆ†æ
- æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š

### 4. ä»£ç å®¡æŸ¥è§†å›¾

#### æ–‡ä»¶å·®å¼‚æ˜¾ç¤º
- å¹¶æ’å¯¹æ¯”æ¨¡å¼
- ç»Ÿä¸€å·®å¼‚æ¨¡å¼
- è¯­æ³•é«˜äº®
- æŠ˜å /å±•å¼€ä»£ç å—

#### è¯„è®ºç³»ç»Ÿ
- è¡Œçº§è¯„è®º
- æ–‡ä»¶çº§è¯„è®º
- è¯„è®ºå›å¤å’Œè®¨è®º
- è¯„è®ºçŠ¶æ€ç®¡ç†

#### AIè¾…åŠ©å»ºè®®
- ä»£ç æ”¹è¿›å»ºè®®
- æ½œåœ¨é—®é¢˜è¯†åˆ«
- æœ€ä½³å®è·µæé†’
- å®‰å…¨æ¼æ´æ£€æµ‹

## æ•°æ®æ¨¡å‹

### ä»£ç è¯„å®¡å®ä½“

```typescript
interface CodeReview {
  id: string;                       // è¯„å®¡ID
  title: string;                    // è¯„å®¡æ ‡é¢˜
  description: string;              // è¯¦ç»†æè¿°
  status: ReviewStatus;             // è¯„å®¡çŠ¶æ€
  priority: Priority;               // ä¼˜å…ˆçº§
  sourceBranch: string;             // æºåˆ†æ”¯
  targetBranch: string;             // ç›®æ ‡åˆ†æ”¯
  author: string;                   // åˆ›å»ºè€…ID
  reviewers: ReviewerAssignment[];  // è¯„å®¡è€…åˆ—è¡¨
  files: ReviewFile[];              // æ–‡ä»¶å˜æ›´åˆ—è¡¨
  comments: ReviewComment[];        // è¯„è®ºåˆ—è¡¨
  commits: CommitInfo[];            // æäº¤ä¿¡æ¯
  aiAnalysis?: AIReviewAnalysis;    // AIåˆ†æç»“æœ
  createdAt: Date;                  // åˆ›å»ºæ—¶é—´
  updatedAt: Date;                  // æ›´æ–°æ—¶é—´
  deadline?: Date;                  // æˆªæ­¢æ—¶é—´
  mergedAt?: Date;                  // åˆå¹¶æ—¶é—´
  mergedBy?: string;                // åˆå¹¶è€…
  labels: string[];                 // æ ‡ç­¾
  linkedIssues: string[];           // å…³è”é—®é¢˜
}

enum ReviewStatus {
  DRAFT = 'draft',                  // è‰ç¨¿
  PENDING = 'pending',              // å¾…è¯„å®¡
  IN_PROGRESS = 'in_progress',      // è¯„å®¡ä¸­
  CHANGES_REQUESTED = 'changes_requested', // éœ€è¦ä¿®æ”¹
  APPROVED = 'approved',            // å·²æ‰¹å‡†
  MERGED = 'merged',                // å·²åˆå¹¶
  CLOSED = 'closed'                 // å·²å…³é—­
}

enum Priority {
  LOW = 'low',                      // ä½
  MEDIUM = 'medium',                // ä¸­
  HIGH = 'high',                    // é«˜
  URGENT = 'urgent'                 // ç´§æ€¥
}

interface ReviewerAssignment {
  userId: string;                   // è¯„å®¡è€…ID
  role: ReviewerRole;               // è¯„å®¡è§’è‰²
  status: ReviewerStatus;           // è¯„å®¡çŠ¶æ€
  assignedAt: Date;                 // åˆ†é…æ—¶é—´
  reviewedAt?: Date;                // è¯„å®¡æ—¶é—´
  decision?: ReviewDecision;        // è¯„å®¡å†³å®š
  comments: string;                 // è¯„å®¡æ„è§
}

enum ReviewerRole {
  REQUIRED = 'required',            // å¿…é¡»è¯„å®¡
  OPTIONAL = 'optional',            // å¯é€‰è¯„å®¡
  APPROVER = 'approver'             // æœ€ç»ˆæ‰¹å‡†è€…
}

enum ReviewerStatus {
  PENDING = 'pending',              // å¾…è¯„å®¡
  IN_PROGRESS = 'in_progress',      // è¯„å®¡ä¸­
  COMPLETED = 'completed'           // å·²å®Œæˆ
}

enum ReviewDecision {
  APPROVE = 'approve',              // æ‰¹å‡†
  REQUEST_CHANGES = 'request_changes', // è¯·æ±‚ä¿®æ”¹
  COMMENT = 'comment'               // ä»…è¯„è®º
}

interface ReviewFile {
  path: string;                     // æ–‡ä»¶è·¯å¾„
  status: FileChangeStatus;         // å˜æ›´çŠ¶æ€
  additions: number;                // æ–°å¢è¡Œæ•°
  deletions: number;                // åˆ é™¤è¡Œæ•°
  changes: DiffHunk[];              // å·®å¼‚å—
  language: string;                 // ç¼–ç¨‹è¯­è¨€
  originalContent?: string;         // åŸå§‹å†…å®¹
  modifiedContent?: string;         // ä¿®æ”¹åå†…å®¹
  comments: FileComment[];          // æ–‡ä»¶è¯„è®º
}

enum FileChangeStatus {
  ADDED = 'added',                  // æ–°å¢
  MODIFIED = 'modified',            // ä¿®æ”¹
  DELETED = 'deleted',              // åˆ é™¤
  RENAMED = 'renamed'               // é‡å‘½å
}

interface ReviewComment {
  id: string;                       // è¯„è®ºID
  type: CommentType;                // è¯„è®ºç±»å‹
  content: string;                  // è¯„è®ºå†…å®¹
  author: string;                   // ä½œè€…ID
  createdAt: Date;                  // åˆ›å»ºæ—¶é—´
  updatedAt?: Date;                 // æ›´æ–°æ—¶é—´
  file?: string;                    // å…³è”æ–‡ä»¶
  line?: number;                    // å…³è”è¡Œå·
  resolved: boolean;                // æ˜¯å¦å·²è§£å†³
  replies: ReplyComment[];          // å›å¤åˆ—è¡¨
  reactions: CommentReaction[];     // ååº”è¡¨æƒ…
}

enum CommentType {
  GENERAL = 'general',              // æ™®é€šè¯„è®º
  ISSUE = 'issue',                  // é—®é¢˜
  SUGGESTION = 'suggestion',        // å»ºè®®
  NITPICK = 'nitpick',             // å°é—®é¢˜
  BLOCKING = 'blocking'             // é˜»å¡é—®é¢˜
}

interface ReplyComment {
  id: string;
  content: string;
  author: string;
  createdAt: Date;
  reactions: CommentReaction[];
}

interface CommentReaction {
  type: 'thumbs_up' | 'thumbs_down' | 'laugh' | 'heart' | 'confused';
  users: string[];
}

interface AIReviewAnalysis {
  codeQuality: CodeQualityScore;
  securityAnalysis: SecurityAnalysis;
  performanceAnalysis: PerformanceAnalysis;
  testCoverage: TestCoverageReport;
  suggestions: AISuggestion[];
  issues: AIIssue[];
  complexity: ComplexityAnalysis;
  maintainability: MaintainabilityScore;
}

interface CodeQualityScore {
  overall: number;                  // æ€»ä½“è¯„åˆ† 0-100
  factors: {
    readability: number;
    consistency: number;
    documentation: number;
    bestPractices: number;
  };
  improvements: string[];
}

interface SecurityAnalysis {
  score: number;                    // å®‰å…¨è¯„åˆ†
  vulnerabilities: SecurityVulnerability[];
  recommendations: string[];
}

interface SecurityVulnerability {
  severity: 'low' | 'medium' | 'high' | 'critical';
  type: string;
  description: string;
  file: string;
  line: number;
  fix: string;
}

interface PerformanceAnalysis {
  impact: 'positive' | 'negative' | 'neutral';
  issues: PerformanceIssue[];
  suggestions: string[];
}

interface PerformanceIssue {
  type: string;
  description: string;
  file: string;
  line: number;
  impact: 'low' | 'medium' | 'high';
}

interface TestCoverageReport {
  current: number;                  // å½“å‰è¦†ç›–ç‡
  change: number;                   // å˜åŒ–å€¼
  missingTests: string[];           // ç¼ºå¤±çš„æµ‹è¯•
  recommendations: string[];
}

interface AISuggestion {
  type: 'improvement' | 'optimization' | 'refactoring';
  title: string;
  description: string;
  file: string;
  line?: number;
  priority: 'low' | 'medium' | 'high';
  example?: string;
}

interface AIIssue {
  severity: 'error' | 'warning' | 'info';
  category: string;
  message: string;
  file: string;
  line: number;
  rule: string;
  fix?: string;
}
```

### è¯„å®¡æµç¨‹é…ç½®

```typescript
interface ReviewWorkflow {
  id: string;
  name: string;
  rules: ReviewRule[];
  approvalPolicy: ApprovalPolicy;
  branchProtection: BranchProtectionRule[];
  automations: ReviewAutomation[];
}

interface ReviewRule {
  id: string;
  name: string;
  condition: RuleCondition;
  action: RuleAction;
  enabled: boolean;
}

interface RuleCondition {
  type: 'file_pattern' | 'branch_pattern' | 'author' | 'size';
  pattern: string;
  operator: 'equals' | 'contains' | 'matches' | 'greater_than';
  value: any;
}

interface RuleAction {
  type: 'require_reviewers' | 'auto_assign' | 'block_merge' | 'notify';
  parameters: Record<string, any>;
}

interface ApprovalPolicy {
  minimumApprovals: number;
  requireCodeOwnerApproval: boolean;
  dismissStaleApprovals: boolean;
  requireUpToDateBranch: boolean;
  allowSelfApproval: boolean;
}

interface BranchProtectionRule {
  branch: string;
  enforceAdmins: boolean;
  requiredStatusChecks: string[];
  requirePullRequestReviews: boolean;
  dismissalRestrictions: string[];
}

interface ReviewAutomation {
  trigger: 'pr_created' | 'pr_updated' | 'review_submitted';
  condition: AutomationCondition;
  action: AutomationAction;
}
```

## çŠ¶æ€ç®¡ç†

### Storeå®šä¹‰

```typescript
interface CodeReviewState {
  // è¯„å®¡åˆ—è¡¨
  reviews: CodeReview[];
  total: number;
  loading: boolean;
  
  // å½“å‰è¯„å®¡
  currentReview: CodeReview | null;
  currentFile: string | null;
  
  // è§†å›¾çŠ¶æ€
  viewMode: 'list' | 'detail' | 'code';
  diffViewMode: 'split' | 'unified';
  showResolved: boolean;
  
  // ç­›é€‰å’Œæ’åº
  filter: ReviewFilter;
  sort: ReviewSort;
  pagination: PaginationState;
  
  // è¯„è®ºç³»ç»Ÿ
  comments: ReviewComment[];
  newComment: string;
  commentMode: CommentMode;
  
  // AIåˆ†æ
  aiAnalysisVisible: boolean;
  analyzing: boolean;
  
  // æ“ä½œçŠ¶æ€
  submitting: boolean;
  approving: boolean;
  merging: boolean;
}

interface CodeReviewActions {
  // æŸ¥è¯¢æ“ä½œ
  fetchReviews: (filter: ReviewFilter) => Promise<void>;
  fetchReviewDetail: (id: string) => Promise<void>;
  searchReviews: (keyword: string) => Promise<void>;
  
  // CRUDæ“ä½œ
  createReview: (data: CreateReviewRequest) => Promise<void>;
  updateReview: (id: string, data: UpdateReviewRequest) => Promise<void>;
  deleteReview: (id: string) => Promise<void>;
  
  // è¯„å®¡æ“ä½œ
  submitReview: (reviewId: string, decision: ReviewDecision, comments: string) => Promise<void>;
  approveReview: (reviewId: string, comments?: string) => Promise<void>;
  requestChanges: (reviewId: string, comments: string) => Promise<void>;
  mergeReview: (reviewId: string, mergeType: MergeType) => Promise<void>;
  
  // è¯„å®¡è€…ç®¡ç†
  addReviewer: (reviewId: string, userId: string, role: ReviewerRole) => Promise<void>;
  removeReviewer: (reviewId: string, userId: string) => Promise<void>;
  updateReviewerRole: (reviewId: string, userId: string, role: ReviewerRole) => Promise<void>;
  
  // è¯„è®ºæ“ä½œ
  addComment: (reviewId: string, comment: CreateCommentRequest) => Promise<void>;
  replyComment: (commentId: string, content: string) => Promise<void>;
  editComment: (commentId: string, content: string) => Promise<void>;
  deleteComment: (commentId: string) => Promise<void>;
  resolveComment: (commentId: string) => Promise<void>;
  addReaction: (commentId: string, reaction: string) => Promise<void>;
  
  // æ–‡ä»¶æ“ä½œ
  selectFile: (filePath: string) => void;
  navigateToNextFile: () => void;
  navigateToPrevFile: () => void;
  
  // è§†å›¾æ§åˆ¶
  setViewMode: (mode: 'list' | 'detail' | 'code') => void;
  setDiffViewMode: (mode: 'split' | 'unified') => void;
  toggleResolvedComments: () => void;
  
  // AIåˆ†æ
  runAIAnalysis: (reviewId: string) => Promise<void>;
  toggleAIAnalysisPanel: () => void;
  
  // ç­›é€‰å’Œæ’åº
  updateFilter: (filter: Partial<ReviewFilter>) => void;
  updateSort: (sort: ReviewSort) => void;
  resetFilter: () => void;
}

interface ReviewFilter {
  status?: ReviewStatus[];
  author?: string[];
  reviewer?: string[];
  assignee?: string[];
  priority?: Priority[];
  labels?: string[];
  dateRange?: DateRange;
  search?: string;
}

interface ReviewSort {
  field: 'createdAt' | 'updatedAt' | 'priority' | 'status' | 'title';
  order: 'asc' | 'desc';
}

enum CommentMode {
  NORMAL = 'normal',
  SUGGESTION = 'suggestion',
  ISSUE = 'issue'
}

enum MergeType {
  MERGE = 'merge',
  SQUASH = 'squash',
  REBASE = 'rebase'
}
```

## é¡µé¢äº¤äº’é€»è¾‘

### 1. è¯„å®¡åˆ—è¡¨ç®¡ç†

```typescript
// åˆå§‹åŒ–è¯„å®¡åˆ—è¡¨
const initializeReviews = async () => {
  loading.value = true;
  try {
    await fetchReviews({
      status: [ReviewStatus.PENDING, ReviewStatus.IN_PROGRESS],
      assignee: [currentUser.value.id]
    });
  } catch (error) {
    showError('åŠ è½½è¯„å®¡åˆ—è¡¨å¤±è´¥ï¼š' + error.message);
  } finally {
    loading.value = false;
  }
};

// ç­›é€‰å™¨å˜æ›´
const handleFilterChange = async (newFilter: Partial<ReviewFilter>) => {
  updateFilter(newFilter);
  await fetchReviews(filter.value);
};

// è¯„å®¡é€‰æ‹©
const handleReviewSelect = async (review: CodeReview) => {
  currentReview.value = review;
  setViewMode('detail');
  
  // åŠ è½½è¯¦ç»†ä¿¡æ¯
  await fetchReviewDetail(review.id);
  
  // é€‰æ‹©ç¬¬ä¸€ä¸ªæ–‡ä»¶
  if (review.files.length > 0) {
    selectFile(review.files[0].path);
  }
};
```

### 2. è¯„å®¡æ“ä½œæµç¨‹

```typescript
// æäº¤è¯„å®¡å†³å®š
const handleSubmitReview = async (decision: ReviewDecision, comments: string) => {
  if (!currentReview.value) return;
  
  try {
    submitting.value = true;
    await submitReview(currentReview.value.id, decision, comments);
    
    // åˆ·æ–°è¯„å®¡çŠ¶æ€
    await fetchReviewDetail(currentReview.value.id);
    
    showSuccess(`è¯„å®¡${getDecisionText(decision)}æˆåŠŸ`);
    
    // å¦‚æœæ˜¯æ‰¹å‡†ï¼Œè¯¢é—®æ˜¯å¦åˆå¹¶
    if (decision === ReviewDecision.APPROVE && canMerge.value) {
      const shouldMerge = await showConfirm('æ˜¯å¦ç«‹å³åˆå¹¶æ­¤ä»£ç ï¼Ÿ');
      if (shouldMerge) {
        await handleMerge();
      }
    }
  } catch (error) {
    showError('æäº¤è¯„å®¡å¤±è´¥ï¼š' + error.message);
  } finally {
    submitting.value = false;
  }
};

// å¿«é€Ÿæ‰¹å‡†
const handleQuickApprove = async (reviewId: string) => {
  try {
    await approveReview(reviewId, 'å¿«é€Ÿæ‰¹å‡†');
    showSuccess('è¯„å®¡æ‰¹å‡†æˆåŠŸ');
    await fetchReviews(filter.value);
  } catch (error) {
    showError('æ‰¹å‡†å¤±è´¥ï¼š' + error.message);
  }
};

// åˆå¹¶ä»£ç 
const handleMerge = async (mergeType: MergeType = MergeType.MERGE) => {
  if (!currentReview.value) return;
  
  const confirmed = await showConfirm(
    `ç¡®è®¤å°† ${currentReview.value.sourceBranch} åˆå¹¶åˆ° ${currentReview.value.targetBranch}ï¼Ÿ`
  );
  
  if (confirmed) {
    try {
      merging.value = true;
      await mergeReview(currentReview.value.id, mergeType);
      showSuccess('ä»£ç åˆå¹¶æˆåŠŸ');
      
      // è¿”å›åˆ—è¡¨é¡µé¢
      setViewMode('list');
      await fetchReviews(filter.value);
    } catch (error) {
      showError('åˆå¹¶å¤±è´¥ï¼š' + error.message);
    } finally {
      merging.value = false;
    }
  }
};
```

### 3. è¯„è®ºç³»ç»Ÿäº¤äº’

```typescript
// æ·»åŠ è¡Œçº§è¯„è®º
const handleAddLineComment = async (file: string, line: number, content: string) => {
  if (!currentReview.value) return;
  
  try {
    await addComment(currentReview.value.id, {
      type: CommentType.GENERAL,
      content,
      file,
      line
    });
    
    // æ¸…ç©ºè¾“å…¥æ¡†
    newComment.value = '';
    
    // åˆ·æ–°è¯„è®ºåˆ—è¡¨
    await fetchReviewDetail(currentReview.value.id);
    
    showSuccess('è¯„è®ºæ·»åŠ æˆåŠŸ');
  } catch (error) {
    showError('æ·»åŠ è¯„è®ºå¤±è´¥ï¼š' + error.message);
  }
};

// å›å¤è¯„è®º
const handleReplyComment = async (commentId: string, content: string) => {
  try {
    await replyComment(commentId, content);
    showSuccess('å›å¤æˆåŠŸ');
    
    // åˆ·æ–°è¯„è®º
    if (currentReview.value) {
      await fetchReviewDetail(currentReview.value.id);
    }
  } catch (error) {
    showError('å›å¤å¤±è´¥ï¼š' + error.message);
  }
};
```

### 4. AIåˆ†æé›†æˆ

```typescript
// è§¦å‘AIåˆ†æ
const handleAIAnalysis = async () => {
  if (!currentReview.value) return;
  
  try {
    analyzing.value = true;
    showProgress('AIæ­£åœ¨åˆ†æä»£ç è¯„å®¡...');
    
    await runAIAnalysis(currentReview.value.id);
    
    // æ˜¾ç¤ºåˆ†æç»“æœ
    aiAnalysisVisible.value = true;
    
    // é«˜äº®æ˜¾ç¤ºé—®é¢˜
    highlightAIIssues();
    
    showSuccess('AIåˆ†æå®Œæˆ');
  } catch (error) {
    showError('AIåˆ†æå¤±è´¥ï¼š' + error.message);
  } finally {
    analyzing.value = false;
    hideProgress();
  }
};
```

## å“åº”å¼è®¾è®¡

### æ¡Œé¢ç«¯ (â‰¥1200px)
- ä¸‰æ å¸ƒå±€ï¼šè¯„å®¡åˆ—è¡¨ + è¯¦æƒ…é¢æ¿ + ä»£ç è§†å›¾
- æ”¯æŒæ‹–æ‹½è°ƒæ•´é¢æ¿å¤§å°
- è¯„è®ºæµ®å±‚æ˜¾ç¤º

### å¹³æ¿ç«¯ (768px-1199px)
- ä¸¤æ å¸ƒå±€ï¼šåˆ—è¡¨/è¯¦æƒ…åˆ‡æ¢ + ä»£ç è§†å›¾
- è¯„è®ºæŠ½å±‰æ˜¾ç¤º
- ç®€åŒ–å·¥å…·æ 

### ç§»åŠ¨ç«¯ (<768px)
- å•æ å¸ƒå±€ï¼Œé¡µé¢åˆ‡æ¢
- åº•éƒ¨å¯¼èˆªæ 
- æ‰‹åŠ¿æ“ä½œæ”¯æŒ

## æ€§èƒ½ä¼˜åŒ–

### 1. è™šæ‹Ÿæ»šåŠ¨å’Œæ‡’åŠ è½½

```typescript
// è¯„å®¡åˆ—è¡¨è™šæ‹Ÿæ»šåŠ¨
const virtualListConfig = {
  itemHeight: 120,
  buffer: 5,
  threshold: 50
};

// ä»£ç å·®å¼‚æ‡’åŠ è½½
const loadFileDiff = async (filePath: string) => {
  if (!diffCache.has(filePath)) {
    const diff = await fetchFileDiff(currentReview.value.id, filePath);
    diffCache.set(filePath, diff);
  }
  return diffCache.get(filePath);
};
```

### 2. çŠ¶æ€ç¼“å­˜

```typescript
// è¯„å®¡è¯¦æƒ…ç¼“å­˜
const reviewCache = new Map<string, CodeReview>();

// è¯„è®ºç¼“å­˜
const commentCache = new Map<string, ReviewComment[]>();

// è‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜
const cleanExpiredCache = () => {
  const now = Date.now();
  const expiry = 5 * 60 * 1000; // 5åˆ†é’Ÿ
  
  for (const [key, data] of reviewCache.entries()) {
    if (now - data.lastAccess > expiry) {
      reviewCache.delete(key);
    }
  }
};
```

## å®‰å…¨è€ƒè™‘

### 1. æƒé™æ§åˆ¶

```typescript
// è¯„å®¡æƒé™æ£€æŸ¥
const checkReviewPermission = (review: CodeReview, action: string): boolean => {
  switch (action) {
    case 'approve':
      return isReviewer(review) && !isAuthor(review);
    case 'merge':
      return hasPermission('repo:merge') && isApproved(review);
    case 'edit':
      return isAuthor(review) || hasPermission('repo:admin');
    default:
      return false;
  }
};
```

## ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### 1. å®æ—¶åä½œ

```typescript
// WebSocketè¿æ¥è¯„å®¡å®æ—¶æ›´æ–°
const setupRealtimeUpdates = (reviewId: string) => {
  const ws = new WebSocket(`ws://api/reviews/${reviewId}/updates`);
  
  ws.onmessage = (event) => {
    const update = JSON.parse(event.data);
    handleRealtimeUpdate(update);
  };
  
  ws.onclose = () => {
    // é‡è¿é€»è¾‘
    setTimeout(() => setupRealtimeUpdates(reviewId), 3000);
  };
};
```

### 2. å¿«æ·é”®æ”¯æŒ

```typescript
// é”®ç›˜å¿«æ·é”®
const keyboardShortcuts = {
  'r': () => handleQuickReply(),           // å¿«é€Ÿå›å¤
  'a': () => handleQuickApprove(),         // å¿«é€Ÿæ‰¹å‡†
  'c': () => showCommentDialog(),          // æ·»åŠ è¯„è®º
  'n': () => navigateToNextFile(),         // ä¸‹ä¸€ä¸ªæ–‡ä»¶
  'p': () => navigateToPrevFile(),         // ä¸Šä¸€ä¸ªæ–‡ä»¶
  'Escape': () => closeCurrentDialog(),    // å…³é—­å¯¹è¯æ¡†
  'Ctrl+Enter': () => submitCurrentForm(), // æäº¤è¡¨å•
  'j': () => navigateToNextDiff(),         // ä¸‹ä¸€ä¸ªå·®å¼‚
  'k': () => navigateToPrevDiff()          // ä¸Šä¸€ä¸ªå·®å¼‚
};
``` 