# å‰åç«¯æ¥å£ä¸€è‡´æ€§åˆ†ææŠ¥å‘Š

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

**åˆ†ææ—¶é—´**: 2024-12-14  
**é¡¹ç›®**: AIç ”å‘è¾…åŠ©å¹³å°  
**åˆ†æèŒƒå›´**: å‰ç«¯(Vue3+TypeScript) ä¸ åç«¯(FastAPI+Python) æ¥å£ä¸€è‡´æ€§  

### ğŸš¨ å…³é”®å‘ç°
- **ä¸¥é‡ä¸ä¸€è‡´**: å‰ç«¯ç¼ºå°‘80%çš„APIå®ç°
- **åŸºç¡€é…ç½®é—®é¢˜**: APIåŸºç¡€URLä¸åŒ¹é…
- **è®¤è¯æœºåˆ¶å·®å¼‚**: ç™»å½•è¯·æ±‚æ ¼å¼ä¸ä¸€è‡´
- **ç±»å‹å®šä¹‰åå·®**: éƒ¨åˆ†æ•°æ®æ¨¡å‹å®šä¹‰ä¸åŒ¹é…

### ğŸ“Š é—®é¢˜ç»Ÿè®¡
| é—®é¢˜ç±»å‹ | æ•°é‡ | ä¸¥é‡ç¨‹åº¦ |
|---------|------|----------|
| ç¼ºå¤±APIå®ç° | 8ä¸ªæ¨¡å— | ğŸ”´ é«˜ |
| è·¯å¾„ä¸åŒ¹é… | 1é¡¹ | ğŸŸ¡ ä¸­ |
| æ ¼å¼ä¸ä¸€è‡´ | 3é¡¹ | ğŸŸ¡ ä¸­ |
| ç±»å‹å®šä¹‰å·®å¼‚ | 5é¡¹ | ğŸŸ  ä¸­ä½ |

## ğŸ” è¯¦ç»†åˆ†æ

### 1. APIè·¯å¾„é…ç½®ä¸åŒ¹é…

**é—®é¢˜æè¿°**:
- åç«¯åŸºç¡€è·¯å¾„: `/api/v1`
- å‰ç«¯é…ç½®è·¯å¾„: `/api` (ç¯å¢ƒå˜é‡ VITE_API_BASE_URL)

**å½±å“**: æ‰€æœ‰APIè°ƒç”¨å°†å¤±è´¥ï¼Œè¿”å›404é”™è¯¯

**ä¿®å¤å»ºè®®**: ---ã€xxä¸éœ€è¦å¤šç¯å¢ƒç®¡ç†ï¼Œå‰åç«¯ç”¨åŒä¸€ä¸ª.envè¿›è¡Œç®¡ç†å³å¯ï¼Œæ”¾åœ¨webç›®å½•ä¸‹ã€‘
```typescript
// å‰ç«¯ä¿®æ”¹ .env æ–‡ä»¶
VITE_API_BASE_URL=http://localhost:8000/api/v1
```

### 2. å‰ç«¯ç¼ºå¤±APIå®ç°æ¨¡å—

#### 2.1 è®¤è¯æ¨¡å— (auth.ts) - ğŸ”´ é«˜ä¼˜å…ˆçº§
**åç«¯å·²å®ç°**:
- `POST /auth/login` - ç”¨æˆ·ç™»å½•
- `POST /auth/register` - ç”¨æˆ·æ³¨å†Œ  
- `POST /auth/refresh` - åˆ·æ–°Token
- `POST /auth/logout` - ç”¨æˆ·ç™»å‡º

**å‰ç«¯çŠ¶æ€**: âŒ å®Œå…¨ç¼ºå¤±
**å½±å“**: ç”¨æˆ·æ— æ³•ç™»å½•ç³»ç»Ÿ

#### 2.2 ç”¨æˆ·ç®¡ç†æ¨¡å— (users.ts) - ğŸ”´ é«˜ä¼˜å…ˆçº§ --ã€æ›´æ–°æ¥å£è·¯å¾„ï¼Œ/user/get /user/update ç­‰å½¢å¼ï¼Œå½“å‰è¿‡äºå¤æ‚ã€‘
**åç«¯å·²å®ç°**:
- `GET /users/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `PUT /users/me` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `PUT /users/me/preferences` - æ›´æ–°ç”¨æˆ·åå¥½
- `POST /users/me/change-password` - ä¿®æ”¹å¯†ç 

**å‰ç«¯çŠ¶æ€**: âŒ å®Œå…¨ç¼ºå¤±
**å½±å“**: ç”¨æˆ·ä¿¡æ¯ç®¡ç†åŠŸèƒ½æ— æ³•ä½¿ç”¨

#### 2.3 éœ€æ±‚ç®¡ç†æ¨¡å— (requirements.ts) - ğŸ”´ é«˜ä¼˜å…ˆçº§
**åç«¯å·²å®ç°**:
- `GET /requirements` - è·å–éœ€æ±‚åˆ—è¡¨
- `POST /requirements` - åˆ›å»ºéœ€æ±‚
- `GET /requirements/{id}` - è·å–éœ€æ±‚è¯¦æƒ…
- `PUT /requirements/{id}` - æ›´æ–°éœ€æ±‚
- `DELETE /requirements/{id}` - åˆ é™¤éœ€æ±‚
- `POST /requirements/upload` - ä¸Šä¼ éœ€æ±‚æ–‡ä»¶

**å‰ç«¯çŠ¶æ€**: âŒ å®Œå…¨ç¼ºå¤±
**å½±å“**: éœ€æ±‚ç®¡ç†æ ¸å¿ƒåŠŸèƒ½æ— æ³•ä½¿ç”¨

#### 2.4 ä»ªè¡¨ç›˜æ¨¡å— (dashboard.ts) - ğŸŸ¡ ä¸­ä¼˜å…ˆçº§
**åç«¯å·²å®ç°**:
- `GET /dashboard/stats` - è·å–ç»Ÿè®¡æ•°æ®
- `GET /dashboard/stats/charts` - è·å–å›¾è¡¨æ•°æ®

**å‰ç«¯çŠ¶æ€**: âŒ å®Œå…¨ç¼ºå¤±
**å½±å“**: æ•°æ®å¯è§†åŒ–åŠŸèƒ½æ— æ³•ä½¿ç”¨

#### 2.5 Gité…ç½®æ¨¡å— (git.ts) - ğŸŸ¡ ä¸­ä¼˜å…ˆçº§
**åç«¯å·²å®ç°**:
- `POST /git/credentials` - åˆ›å»ºGitå‡­è¯
- `GET /git/credentials` - è·å–å‡­è¯åˆ—è¡¨
- `PUT /git/credentials/{id}` - æ›´æ–°å‡­è¯
- `DELETE /git/credentials/{id}` - åˆ é™¤å‡­è¯
- `POST /git/credentials/test` - æµ‹è¯•è¿æ¥
- `POST /git/repositories` - åˆ›å»ºä»“åº“é…ç½®
- `GET /git/repositories` - è·å–ä»“åº“åˆ—è¡¨

**å‰ç«¯çŠ¶æ€**: âŒ å®Œå…¨ç¼ºå¤±
**å½±å“**: Gité›†æˆåŠŸèƒ½æ— æ³•ä½¿ç”¨

#### 2.6 çŸ¥è¯†åº“æ¨¡å— (knowledge.ts) - ğŸŸ  ä¸­ä½ä¼˜å…ˆçº§
**åç«¯å·²å®ç°**:
- `POST /knowledge-bases` - åˆ›å»ºçŸ¥è¯†åº“
- `GET /knowledge-bases` - è·å–çŸ¥è¯†åº“åˆ—è¡¨
- `POST /knowledge-bases/{id}/documents/upload` - ä¸Šä¼ æ–‡æ¡£
- `POST /knowledge-bases/{id}/search` - RAGæœç´¢

**å‰ç«¯çŠ¶æ€**: âŒ å®Œå…¨ç¼ºå¤±
**å½±å“**: çŸ¥è¯†åº“åŠŸèƒ½æ— æ³•ä½¿ç”¨

#### 2.7 ä»»åŠ¡ç®¡ç†æ¨¡å— (tasks.ts) - ğŸŸ¡ ä¸­ä¼˜å…ˆçº§
**åç«¯å·²å®ç°**:
- `GET /tasks/code-diff` - è·å–ä»£ç å·®å¼‚ä»»åŠ¡
- `POST /tasks/code-diff` - åˆ›å»ºä»£ç å·®å¼‚ä»»åŠ¡
- `GET /tasks/requirements` - è·å–éœ€æ±‚è§£æä»»åŠ¡
- `POST /tasks/requirements` - åˆ›å»ºéœ€æ±‚è§£æä»»åŠ¡
- `GET /tasks/pipeline` - è·å–æµæ°´çº¿ä»»åŠ¡
- `POST /tasks/pipeline` - åˆ›å»ºæµæ°´çº¿ä»»åŠ¡

**å‰ç«¯çŠ¶æ€**: âŒ å®Œå…¨ç¼ºå¤±
**å½±å“**: ä»»åŠ¡ç®¡ç†åŠŸèƒ½æ— æ³•ä½¿ç”¨

#### 2.8 ä»£ç è¯„å®¡æ¨¡å— (code-review.ts) - ğŸŸ  ä¸­ä½ä¼˜å…ˆçº§
**åç«¯å·²å®ç°**:
- `GET /code-review/diffs` - è·å–ä»£ç å·®å¼‚
- `POST /code-review/diffs` - ç”Ÿæˆä»£ç å·®å¼‚
- `GET /code-review/tasks` - è·å–è¯„å®¡ä»»åŠ¡
- `POST /code-review/tasks` - åˆ›å»ºè¯„å®¡ä»»åŠ¡

**å‰ç«¯çŠ¶æ€**: âŒ å®Œå…¨ç¼ºå¤±
**å½±å“**: ä»£ç è¯„å®¡åŠŸèƒ½æ— æ³•ä½¿ç”¨

### 3. è®¤è¯æ ¼å¼ä¸ä¸€è‡´---ã€ç»Ÿä¸€jsonæ ¼å¼ã€‘

**é—®é¢˜æè¿°**:
- åç«¯æœŸæœ›: `Content-Type: application/x-www-form-urlencoded`
- å‰ç«¯å½“å‰: JSONæ ¼å¼è¯·æ±‚

**åç«¯ç™»å½•æ¥å£**:
```python
@router.post("/login")
def login(
    username: str = Form(...),
    password: str = Form(...),
    request: Request
):
```

**ä¿®å¤å»ºè®®**:
```typescript
// å‰ç«¯éœ€è¦ä½¿ç”¨FormDataæ ¼å¼
const loginApi = {
  login: (username: string, password: string) => {
    const formData = new FormData()
    formData.append('username', username)
    formData.append('password', password)
    return api.post('/auth/login', formData, {
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
    })
  }
}
```

### 4. ç±»å‹å®šä¹‰å·®å¼‚

#### 4.1 ç”¨æˆ·ä¿¡æ¯ç±»å‹ä¸åŒ¹é…---ã€ç”¨æˆ·ä¿¡æ¯ä½¿ç”¨ç®€ä¾¿çš„ï¼Œæ²¡ç”¨çš„åˆ é™¤ã€‘
**åç«¯UserResponse**:
```python
class UserResponse(BaseModel):
    id: int
    username: str
    email: str
    full_name: Optional[str]
    avatar_url: Optional[str]
    bio: Optional[str]
    preferences: Optional[Dict[str, Any]]
    is_active: bool
    is_verified: bool
    login_count: int
    last_login_at: Optional[str]
    created_at: datetime
    updated_at: datetime
```

**å‰ç«¯UserInfo**:
```typescript
interface UserInfo {
  id: string  // ç±»å‹ä¸åŒ¹é…ï¼šåç«¯æ˜¯intï¼Œå‰ç«¯æ˜¯string
  username: string
  email: string
  nickname?: string  // å­—æ®µåä¸åŒ¹é…ï¼šåç«¯æ˜¯full_name
  avatar?: string    // å­—æ®µåä¸åŒ¹é…ï¼šåç«¯æ˜¯avatar_url
  department?: string // åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  position?: string   // åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  roles: string[]     // åç«¯æ²¡æœ‰æ­¤å­—æ®µ
}
```

#### 4.2 AIæ¨¡å‹é…ç½®ç±»å‹å·®å¼‚---ã€ç»Ÿä¸€ä¸ºå¸¸ç”¨æ ¼å¼ã€‘
**å­—æ®µåŒ¹é…åº¦**: 90%
**ä¸»è¦å·®å¼‚**: 
- å‰ç«¯ç¼ºå°‘ `usage_count` å’Œ `total_tokens_used` å­—æ®µ
- æ—¶é—´æ ¼å¼å¤„ç†æ–¹å¼ä¸åŒ

### 5. å“åº”æ ¼å¼éªŒè¯

**åç«¯StandardJSONResponse**:
```python
{
    "code": 200,
    "message": "success", 
    "data": {},
    "timestamp": "2024-12-01T10:00:00Z"
}
```

**å‰ç«¯ApiResponse**:
```typescript
interface ApiResponse<T = any> {
  code: number
  message: string
  data: T
}
```

**é—®é¢˜**: å‰ç«¯ç±»å‹å®šä¹‰ç¼ºå°‘ `timestamp` å­—æ®µ

## ğŸ¯ ä¿®å¤å»ºè®®ä¸ä¼˜å…ˆçº§

### é˜¶æ®µä¸€ï¼šæ ¸å¿ƒåŠŸèƒ½ä¿®å¤ (é«˜ä¼˜å…ˆçº§)
1. **ä¿®å¤APIåŸºç¡€è·¯å¾„é…ç½®** - 1å°æ—¶
2. **å®ç°è®¤è¯æ¨¡å—API** - 4å°æ—¶
3. **å®ç°ç”¨æˆ·ç®¡ç†API** - 3å°æ—¶  
4. **å®ç°éœ€æ±‚ç®¡ç†API** - 6å°æ—¶

### é˜¶æ®µäºŒï¼šæ‰©å±•åŠŸèƒ½å®ç° (ä¸­ä¼˜å…ˆçº§)
1. **å®ç°ä»ªè¡¨ç›˜API** - 3å°æ—¶
2. **å®ç°Gité…ç½®API** - 4å°æ—¶
3. **å®ç°ä»»åŠ¡ç®¡ç†API** - 5å°æ—¶

### é˜¶æ®µä¸‰ï¼šå®Œå–„åŠŸèƒ½ (ä¸­ä½ä¼˜å…ˆçº§)
1. **å®ç°çŸ¥è¯†åº“API** - 4å°æ—¶
2. **å®ç°ä»£ç è¯„å®¡API** - 3å°æ—¶
3. **ç»Ÿä¸€ç±»å‹å®šä¹‰** - 2å°æ—¶

## ğŸ“‹ å®æ–½æ£€æŸ¥æ¸…å•

### ç«‹å³ä¿®å¤é¡¹
- [ ] ä¿®æ”¹å‰ç«¯APIåŸºç¡€è·¯å¾„é…ç½®
- [ ] åˆ›å»ºauth.tsè®¤è¯APIæ¨¡å—
- [ ] åˆ›å»ºusers.tsç”¨æˆ·ç®¡ç†APIæ¨¡å—
- [ ] ä¿®å¤ç™»å½•è¯·æ±‚æ ¼å¼

### çŸ­æœŸå®æ–½é¡¹ (1-2å‘¨)
- [ ] å®ç°requirements.tséœ€æ±‚ç®¡ç†API
- [ ] å®ç°dashboard.tsä»ªè¡¨ç›˜API
- [ ] å®ç°git.ts Gité…ç½®API
- [ ] å®ç°tasks.tsä»»åŠ¡ç®¡ç†API

### ä¸­æœŸå®Œå–„é¡¹ (2-4å‘¨)
- [ ] å®ç°knowledge.tsçŸ¥è¯†åº“API
- [ ] å®ç°code-review.tsä»£ç è¯„å®¡API
- [ ] ç»Ÿä¸€å‰åç«¯ç±»å‹å®šä¹‰
- [ ] å®Œå–„é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ”§ æŠ€æœ¯å»ºè®®

1. **ä½¿ç”¨ä»£ç ç”Ÿæˆå·¥å…·**: è€ƒè™‘ä½¿ç”¨OpenAPIç”Ÿæˆå™¨è‡ªåŠ¨ç”Ÿæˆå‰ç«¯APIå®¢æˆ·ç«¯
2. **å»ºç«‹ç±»å‹å…±äº«**: åˆ›å»ºå…±äº«çš„ç±»å‹å®šä¹‰æ–‡ä»¶
3. **APIæ–‡æ¡£åŒæ­¥**: ç¡®ä¿å‰åç«¯APIæ–‡æ¡£å®æ—¶åŒæ­¥
4. **è‡ªåŠ¨åŒ–æµ‹è¯•**: å»ºç«‹å‰åç«¯æ¥å£é›†æˆæµ‹è¯•

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2024-12-14  
**ä¸‹æ¬¡æ£€æŸ¥å»ºè®®**: ä¿®å¤å®Œæˆåè¿›è¡Œå…¨é¢å›å½’æµ‹è¯•
